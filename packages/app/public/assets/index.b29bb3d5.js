var _t=Object.defineProperty;var ft=(a,o,t)=>o in a?_t(a,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[o]=t;var I=(a,o,t)=>(ft(a,typeof o!="symbol"?o+"":o,t),t);import{N as Ye,B as ye,M as fe,a as M,S as mt,l as Ft,C as ht,A as yt,b as vt,I as Et}from"./@arco-design.02506a81.js";import{X as z,k as p,l as B,m as u,j as f,a5 as Ke,O as je,a as N,w as ue,e as j,y as v,z as A,C as te,c as ae,p as g,v as e,a1 as _,n as m,a3 as De,a4 as xe,a6 as He,t as we,q as Pe,u as ke,x as K,r as L,F as S,Q as U,s as $,H as Te,o as ie,a7 as wt,M as le,N as re,f as Me,K as Ct,a2 as ce,_ as gt}from"./@vue.673b5b32.js";import{u as bt,c as Bt,a as Dt}from"./vue-router.6abf7ce6.js";import{d as xt,c as kt,a as At}from"./lodash.982f82b0.js";import{d as Xe}from"./dayjs.da6ee055.js";import{a as Ze}from"./axios.510e2250.js";import{E as $t}from"./events.06ff727b.js";import{V as St}from"./vue3-colorpicker.19928d45.js";/* empty css                       */import"./resize-observer-polyfill.375322e1.js";import"./compute-scroll-into-view.079a5c71.js";import"./b-tween.3dc4e04f.js";import"./b-validate.ed490c04.js";import"./number-precision.a111f450.js";import"./scroll-into-view-if-needed.10a505ff.js";import"./vue-types.b3d8d5bc.js";import"./tinycolor2.bbf7e834.js";import"./@vueuse.e34a2acb.js";import"./@aesoper.438b8cd9.js";import"./vue3-angle.146159a3.js";import"./gradient-parser.91181912.js";import"./lodash-es.089f0d41.js";import"./@popperjs.2eb658a9.js";const Ot=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}};Ot();const pe=typeof global=="undefined";pe===!1&&(window.electron=require("electron"),window.child_process=require("child_process"));const oe=window.electron||{ipcRenderer:{sendSync:()=>{},send:()=>{},on:()=>{},once:()=>{}}},Re=window.child_process||{};class de{constructor(o){this._text=o}static nowrap(o){return(o==null?void 0:o.replace(/\n/g,""))||""}nowrap(){return this._text=de.nowrap(this._text),this}static noSpecialChar(o){return(o==null?void 0:o.replace(/[^\w\s]/gi,""))||""}noSpecialChar(){return this._text=de.noSpecialChar(this._text),this}static max(o,t){return o.length>t?o.substring(0,t)+"...":o}max(o){return this._text=de.max(this._text,o),this}static hide(o,t,n,s="*"){return o.substring(0,t)+o.substring(t,n).replace(/./g,s)+o.substring(n)}hide(o,t,n="*"){return this._text=de.hide(this._text,o,t,n),this}static of(o){return new de(o)}toString(){return this._text}}const{clipboard:Vt}=oe;function Q(a,o,t,n){var s;return Ye[(n==null?void 0:n.type)||"info"]({id:t,title:a,closable:!0,content:()=>z("span",{title:String(o)},de.max(String(o),100)),duration:(s=n==null?void 0:n.duration)!=null?s:(n==null?void 0:n.type)==="error"?6e3:3e3,footer:()=>(n==null?void 0:n.btn)||z("div",[n!=null&&n.copy?jt(a,o,t,n):"",n!=null&&n.close?zt(t):""])})}function zt(a){return z(ye,{type:"primary",size:"small",onClick:()=>{Ye.remove(a)}},"\u5173\u95ED")}function jt(a,o,t,n){return z(ye,{type:"primary",size:"small",onClick:()=>{Vt.writeText(a+`
`+String(o)),Q(a,o,t,{...n,btn:z(ye,{type:"primary",size:"small",disabled:!0},"\u590D\u5236\u6210\u529F\u221A")})}},"\u590D\u5236\u4FE1\u606F")}const{ipcRenderer:Se}=oe;function J(a){function o(n,...s){const r=Se.sendSync(n,...s);return r!=null&&r.error&&Q("remote \u6A21\u5757\u9519\u8BEF",r.error,"remote",{copy:!0,type:"error"}),r}function t(n,s){return new Promise(r=>{Se.once(s[0],(d,...i)=>{i[0].error?Q("remote \u6A21\u5757\u9519\u8BEF",i[0].error,"remote",{copy:!0,type:"error"}):r(i[0].data)}),Se.send(n,JSON.parse(JSON.stringify(s)))})}return{get(n){return o(a+"-get",[n])},set(n,s){return o(a+"-set",[n,s])},call(n,...s){const r=Pt(n.toString());return t(a+"-call",[r,n,...s])}}}function Pt(a){return`${a}-${(Math.random()*1e3).toFixed(0)}-${Date.now()}`}const D={"electron-store":J("electron-store"),fs:J("fs"),path:J("path"),os:J("os"),crypto:J("crypto"),OCSApi:J("OCSApi"),win:J("win"),webContents:J("webContents"),app:J("app"),dialog:J("dialog"),methods:J("methods"),logger:J("logger"),desktopCapturer:J("desktopCapturer")};var R=(a,o)=>{const t=a.__vccOpts||a;for(const[n,s]of o)t[n]=s;return t};const Tt={};function It(a,o){const t=f("router-view");return p(),B(t,null,{default:u(({Component:n})=>[(p(),B(Ke,null,[(p(),B(je(n)))],1024))]),_:1})}var Mt=R(Tt,[["render",It],["__scopeId","data-v-3898e5f4"]]);const F=N(xt(pe?JSON.parse(localStorage.getItem("ocs-app-store")||"{}"):D["electron-store"].get("store"),{render:{scripts:[],notifies:[],browser:{currentFolderUid:"",currentBrowserUid:"",root:{name:"\u6839\u76EE\u5F55",parent:void 0,createTime:Date.now(),type:"root",uid:"root-folder",children:{},renaming:!1},tags:{},search:{value:"",tags:[],results:void 0}},dashboard:{details:{tags:!1,notes:!1},num:4,video:{aspectRatio:0}},setting:{browserType:"diy",launchOptions:{executablePath:""},theme:{dark:!1},window:{alwaysOnTop:!1,autoLaunch:!1}},state:{first:!0,setup:!0,mini:!1,responsive:"small"}}}));N([]);N(new Map);ue(()=>kt(F.render.setting.theme),(a,o)=>{a.dark?document.body.setAttribute("arco-theme","dark"):document.body.removeAttribute("arco-theme")});ue(F,a=>{pe?localStorage.setItem("ocs-app-store",JSON.stringify(a)):D["electron-store"].set("store",JSON.parse(JSON.stringify(a)))},{deep:!0});ue(()=>F.render.setting.window.autoLaunch,Ge);ue(()=>F.render.setting.window.alwaysOnTop,Qe);function Rt(){F.render.setting.theme.dark?document.body.setAttribute("arco-theme","dark"):document.body.removeAttribute("arco-theme")}function Ge(){D.methods.call("autoLaunch")}function Qe(){D.win.call("setAlwaysOnTop",F.render.setting.window.alwaysOnTop)}class Ut{static async getInfos(){const{data:o}=await Ze.get("https://cdn.ocsjs.com/infos.json?t="+Date.now());return o}}const{ipcRenderer:Ue}=oe;function Lt(a){return new Promise(o=>setTimeout(o,a))}function Le(a){return Xe(a).format("YYYY-MM-DD")}function Ne(a){return Xe(a).format("YYYY-MM-DD hh:mm")}async function et(a){try{let t=(await Ae()).notify;const n=F.render.notifies;a||(t=t.filter(s=>n.findIndex(r=>(s==null?void 0:s.id)===(r==null?void 0:r.id))===-1)),t.length&&fe.confirm({title:()=>"\u{1F389}\u6700\u65B0\u516C\u544A\u{1F389}",okText:a?"\u786E\u5B9A":"\u6715\u5DF2\u9605\u8BFB",cancelText:a?"\u53D6\u6D88":"\u4E0B\u6B21\u4E00\u5B9A",hideCancel:!1,simple:!0,width:600,content:()=>z("div",{style:{maxHeight:"320px",overflow:"auto"}},t.map(s=>z("div",[z("div",{style:{marginBottom:"6px",fontWeight:"bold"}},(s==null?void 0:s.id)||"\u65E0\u6807\u9898"),z("ul",s.content.map(r=>z("li",r)))]))),onOk(){a||(F.render.notifies=[...F.render.notifies].concat(t))},onCancel(){}})}catch(o){M.error("\u6700\u65B0\u901A\u77E5\u83B7\u53D6\u5931\u8D25\uFF1A"+o)}}async function Ae(){return await Ut.getInfos()}async function tt({name:a,dest:o,url:t}){const n=(s,r,d,i,c)=>{qt(a,r,d,i,c)};Ue.on("download",n);try{await D.methods.call("download","download-file-"+a,t,o)}catch(s){M.error("\u4E0B\u8F7D\u9519\u8BEF "+s.message)}return Ue.removeListener("download",n),o}async function Nt({name:a,filename:o,folder:t,url:n}){M.info("\u6B63\u5728\u4E0B\u8F7D "+a);const s=await D.path.call("join",t,`${o}.zip`),r=await D.path.call("join",t,o);return await tt({name:a,dest:s,url:n}),Q("\u6587\u4EF6\u89E3\u538B",`${a} \u89E3\u538B\u4E2D...`,"download-file-"+a,{type:"info",duration:0}),await D.methods.call("unzip",s,r),await D.fs.call("unlinkSync",s),Q("\u6587\u4EF6\u4E0B\u8F7D",`${a} \u4E0B\u8F7D\u5B8C\u6210\uFF01`,"download-file-"+a,{type:"success",duration:3e3}),r}function qt(a,o,t,n,s){if(o==="download-file-"+a)return t===100?Q("\u6587\u4EF6\u4E0B\u8F7D",`${a} \u4E0B\u8F7D\u5B8C\u6210: ${(s/1024/1024).toFixed(2)}MB`,"download-file-"+a,{type:"success",duration:0}):Q("\u6587\u4EF6\u4E0B\u8F7D",`${a} \u4E0B\u8F7D\u4E2D: ${(n/1024/1024).toFixed(2)}MB/${(s/1024/1024).toFixed(2)}MB`,"download-file-"+a,{type:"info",duration:0})}async function ut(){F.render.state.first=!1;const a=await D.app.call("getVersion");fe.info({title:"\u5173\u4E8E\u8F6F\u4EF6",closable:!0,simple:!1,maskClosable:!0,content:()=>z("div",[z("p",{innerHTML:"&nbsp;&nbsp;OCS\u684C\u9762\u7248\u8F6F\u4EF6\u901A\u8FC7\u64CD\u63A7\u6D4F\u89C8\u5668\u53EF\u4EE5\u8FDB\u884C\u6D4F\u89C8\u5668\u591A\u5F00\uFF08\u6BCF\u4E2A\u6D4F\u89C8\u5668\u6570\u636E\u4E0D\u5171\u4EAB\uFF0C\u53EF\u4EE5\u5B9E\u73B0\u6BCF\u4E2A\u7F51\u7AD9\u767B\u5F55\u4E0D\u540C\u7684\u8D26\u53F7\uFF09\uFF0C\u5E76\u4E14\u6709\u5F3A\u5927\u7684\u6D4F\u89C8\u5668\u7BA1\u7406\u529F\u80FD\u4EE5\u53CA\u6D4F\u89C8\u5668\u5C4F\u5E55\u76D1\u63A7\u529F\u80FD\u3002"}),z("p",{innerHTML:"&nbsp;&nbsp;\u901A\u8FC7\u5B89\u88C5\u7528\u6237\u811A\u672C\u7BA1\u7406\u5668\uFF08\u4F8B\u5982\u811A\u672C\u732B\uFF0C\u6CB9\u7334\uFF09\uFF0C\u5E76\u5B89\u88C5\u62E5\u6709\u5404\u79CD\u529F\u80FD\u7684\u7528\u6237\u811A\u672C\uFF0C\u53EF\u4EE5\u62D3\u5C55\u66F4\u591A\u6D4F\u89C8\u5668\u529F\u80FD\u3002"}),z("ul",{style:{paddingLeft:"12px"}},[z("li","\u8F6F\u4EF6\u7248\u672C : "+a),z("li",[z("span","\u8F6F\u4EF6\u5B98\u7F51 : "),z("a",{href:"#",onClick:()=>oe.shell.openExternal("https://docs.ocsjs.com/")},"https://docs.ocsjs.com")]),z("li",[z("span","\u8F6F\u4EF6\u4E0B\u8F7D : "),z("a",{href:"#",onClick:()=>oe.shell.openExternal("https://docs.ocsjs.com/docs/\u8D44\u6E90\u4E0B\u8F7D/app-downloads")},"https://docs.ocsjs.com/docs/\u8D44\u6E90\u4E0B\u8F7D/app-downloads")])])])})}const qe=j({__name:"TitleLink",props:{url:null,title:null},setup(a){const{shell:o}=oe;function t(n){o.openExternal(n)}return(n,s)=>{const r=f("a-doption");return p(),B(r,{onClick:s[0]||(s[0]=d=>t(a.url))},{default:u(()=>[v(A(a.title),1)]),_:1})}}});class ne extends $t{constructor(t,n){super();I(this,"uid");I(this,"shell");I(this,"worker");I(this,"status","closed");I(this,"browser");I(this,"launchOptions");I(this,"video");I(this,"stream");this.browser=t,this.uid=t.uid,this.launchOptions=n}static from(t){return q.find(n=>n.uid===t)}async init(t){var s,r,d;this.shell=Re.fork(await D.path.call("join",await D.app.call("getAppPath"),"./script.js"),{stdio:["ipc"],env:process.env}),this.worker=Jt(this.shell),(s=this.shell.stdout)==null||s.on("data",i=>t==null?void 0:t(i.toString())),(r=this.shell.stderr)==null||r.on("data",i=>t==null?void 0:t(i.toString())),(d=this.shell.stderr)==null||d.on("data",i=>D.logger.call("error",String(i)));const n={launched:async()=>{this.status="launched"},"browser-closed":()=>{this.status="closed"}};this.shell.on("close",()=>{this.status="closed"}),this.shell.on("message",({event:i,args:c})=>{this.emit(i,...c),n[i]&&n[i](...c)}),this.worker("init",{store:F,cachePath:this.browser.cachePath,uid:this.uid})}launch(){return new Promise((t,n)=>{this.launchOptions.executablePath?D.fs.call("existsSync",this.launchOptions.executablePath).then(s=>{var r;s?(this.status="launching",this.once("launched",t),(r=this.worker)==null||r.call(this,"launch",{userDataDir:this.browser.cachePath,scripts:F.render.scripts.filter(d=>d.enable).map(d=>d.url),...this.launchOptions})):M.error("\u6D4F\u89C8\u5668\u8DEF\u5F84\u4E0D\u5B58\u5728\uFF0C\u8BF7\u4FEE\u6539\u3002")}).catch(s=>{M.error("\u6D4F\u89C8\u5668\u8DEF\u5F84\u8BFB\u53D6\u9519\u8BEF : ",s)}):M.error("\u6D4F\u89C8\u5668\u8DEF\u5F84\u4E0D\u5B58\u5728\uFF0C\u8BF7\u4FEE\u6539\u3002")})}async close(){return new Promise((t,n)=>{var s;this.once("browser-closed",t),(s=this.worker)==null||s.call(this,"close")})}bringToFront(){if(this.status==="launched"&&this.launchOptions){const t=`http://localhost:${F.server.port}/ocs-action_bring-to-top`;Re.exec(`"${this.launchOptions.executablePath}" --user-data-dir="${this.browser.cachePath}" "${t}"`)}else M.warning("\u5FC5\u987B\u5148\u542F\u52A8\u6587\u4EF6")}toString(){return"[Process]"}}const q=N([]);function Jt(a){return(o,...t)=>{a.connected&&a.send({event:o,args:t})}}function ve(){F.render.browser.search.value="",F.render.browser.search.tags=[]}class Ee{constructor(o){I(this,"uid");I(this,"name");I(this,"createTime");I(this,"renaming");this.uid=o.uid,this.name=o.name,this.createTime=o.createTime,this.renaming=o.renaming}static async uuid(){return(pe?Date.now().toFixed(0)+(Math.random()*1e3).toFixed(0):await D.crypto.call("randomUUID")).replace(/-/g,"")}}class G extends Ee{constructor(t){super(t);I(this,"type");I(this,"tags");I(this,"notes");I(this,"checked");I(this,"cachePath");I(this,"histories");I(this,"parent");I(this,"store",N({}));this.type="browser",this.tags=t.tags,this.notes=t.notes,this.checked=t.checked,this.cachePath=t.cachePath,this.histories=t.histories,this.parent=t.parent,this.store=t.store}static from(t){return Z().find("browser",t)}async launch(){const t=new ne(this,{executablePath:F.render.setting.launchOptions.executablePath,headless:!1});q.push(t);const n=ne.from(this.uid);n&&(await n.init(console.log),await n.launch()),this.histories.unshift({action:"\u8FD0\u884C",time:Date.now()})}async relaunch(){const t=ne.from(this.uid);t==null||t.emit("relaunching"),this.histories.unshift({action:"\u91CD\u542F",time:Date.now()}),await(t==null?void 0:t.close()),await(t==null?void 0:t.launch()),t==null||t.emit("relaunched")}async close(){const t=ne.from(this.uid);await(t==null?void 0:t.close());const n=q.findIndex(s=>s.uid===this.uid);n!==-1&&q.splice(n,1),this.histories.unshift({action:"\u5173\u95ED",time:Date.now()})}bringToFront(){const t=ne.from(this.uid);t==null||t.bringToFront()}location(){me.push("/"),ve(),F.render.browser.currentFolderUid=this.parent,te(()=>{F.render.browser.currentBrowserUid=this.uid,this.select()})}select(){F.render.browser.currentBrowserUid=this.uid}async remove(){const t=ne.from(this.uid);t&&await t.close();const n=X.from(this.parent);Reflect.deleteProperty((n==null?void 0:n.children)||{},this.uid),await D.fs.call("existsSync",this.cachePath)&&await D.fs.call("rmSync",this.cachePath,{recursive:!0})}rename(t){this.name!==t&&this.histories.unshift({action:"\u6539\u540D",content:`${this.name} => ${t}`,time:Date.now()}),this.name=t,this.renaming=!1}}class X extends Ee{constructor(t){super(t);I(this,"type");I(this,"parent");I(this,"children",{});this.type=t.type,this.parent=t.parent,this.children=t.children;for(const n in this.children)if(Object.prototype.hasOwnProperty.call(this.children,n)){const s=this.children[n];s.type==="browser"?this.children[n]=new G(s):this.children[n]=new X(s)}}static from(t){return t===Z().uid?Z():Z().find("folder",t)}find(t,n){let s=this.children[n];if(s&&s.type===t)return s;for(const r in this.children)if(Object.prototype.hasOwnProperty.call(this.children,r)){const d=this.children[r];if(d.type==="folder"){const i=d.find(t,n);s=s||i}}return s}findAll(t){const n=[];for(const s in this.children)if(Object.prototype.hasOwnProperty.call(this.children,s)){const r=this.children[s];t(r)&&n.push(r),r.type==="folder"&&n.push(...r.findAll(t))}return n}flatParents(){let t;if(this.parent){const n=X.from(this.parent);n&&(t=n.flatParents())}return[...t||[],this]}location(){me.push("/"),ve(),F.render.browser.currentFolderUid=this.uid}select(){F.render.browser.currentFolderUid=this.uid}remove(){if(this.parent){const t=X.from(this.parent);t&&Reflect.deleteProperty(t.children,this.uid)}}rename(t){this.name=t,this.renaming=!1}}let ge;const Z=()=>ge||(ge=N(new X(F.render.browser.root)));ue(()=>ge,()=>{F.render.browser.root=JSON.parse(JSON.stringify(Z))});const H=ae(()=>Z().find("folder",F.render.browser.currentFolderUid)||Z()),be=ae(()=>H.value.children),se=ae(()=>Z().find("browser",F.render.browser.currentBrowserUid)),W=ae(()=>{if(!(F.render.browser.search.value===""&&F.render.browser.search.tags.length===0))return console.log(F.render.browser.search.tags),Z().findAll(a=>F.render.browser.search.value!==""&&(a.name.indexOf(F.render.browser.search.value)!==-1||a.type==="browser"&&a.notes.indexOf(F.render.browser.search.value)!==-1)||F.render.browser.search.tags.length!==0&&F.render.browser.search.tags.some(o=>a.type==="browser"&&a.tags.some(t=>t.name===o)))});const ot=a=>(De("data-v-67b6c290"),a=a(),xe(),a),Wt={class:"title border-bottom ps-2"},Yt=ot(()=>m("span",{class:"title-item"}," \u5DE5\u5177 ",-1)),Kt=ot(()=>m("span",{class:"title-item"}," \u5E2E\u52A9 ",-1)),Ht=j({__name:"Title",setup(a){const{shell:o}=oe;function t(y){return typeof window=="undefined"?D.webContents.call(y):document.execCommand(y)}function n(){D.app.call("relaunch"),D.app.call("quit")}async function s(){const y=await D.path.call("join",await D.app.call("getPath","logs"),Le(Date.now()));o.openPath(y)}function r(){et(!0)}function d(){D.dialog.call("showOpenDialog",{title:"\u9009\u62E9\u6570\u636E\u6587\u4EF6",buttonLabel:"\u5BFC\u51FA",filters:[{extensions:["ocsdata"],name:"ocsdata"}]}).then(async({canceled:y,filePaths:h})=>{if(y===!1&&h)try{const C=await D.fs.call("readFileSync",h[0],{encoding:"utf8"});JSON.parse(C.toString()),await D.fs.call("copyFileSync",h[0],F["config-path"]),M.success("\u5BFC\u5165\u6210\u529F\uFF01\u6570\u636E\u91CD\u542F\u540E\u751F\u6548\u3002")}catch(C){M.error("\u6570\u636E\u6709\u8BEF! : "+C)}})}function i(){D.dialog.call("showSaveDialog",{title:"\u9009\u62E9\u5BFC\u51FA\u4F4D\u7F6E",buttonLabel:"\u5BFC\u51FA",defaultPath:`config-${Le(Date.now())}`}).then(async({canceled:y,filePath:h})=>{y===!1&&h&&(await D.fs.call("copyFileSync",F["config-path"],h+".ocsdata"),M.success("\u5BFC\u51FA\u6210\u529F\uFF01"))})}function c(y){y.preventDefault()}function l(){window.ocs={currentBrowser:se,currentEntities:be,currentFolder:H,currentSearchedEntities:W,root:Z,store:F},D.webContents.call("openDevTools")}return(y,h)=>{const C=f("a-doption"),E=f("a-dropdown"),w=f("a-col"),b=f("a-row");return p(),g("div",Wt,[e(E,{class:"tittle-dropdown",position:"bl",trigger:"hover","popup-max-height":!1},{content:u(()=>[e(C,{style:{width:"200px"}}),e(C,{onClick:i},{default:u(()=>[v(" \u5BFC\u51FA\u6570\u636E ")]),_:1}),e(C,{class:"border-bottom",onClick:d},{default:u(()=>[v(" \u5BFC\u5165\u6570\u636E ")]),_:1}),e(C,{onClick:h[0]||(h[0]=O=>_(F).state.setup=!0)},{default:u(()=>[v(" \u521D\u59CB\u5316\u8BBE\u7F6E ")]),_:1}),e(C,{onClick:n},{default:u(()=>[v(" \u91CD\u542F\u8F6F\u4EF6 ")]),_:1}),e(C,{onClick:s},{default:u(()=>[v(" \u65E5\u5FD7\u76EE\u5F55 ")]),_:1}),e(C,{onClick:l},{default:u(()=>[v(" \u5F00\u53D1\u8005\u5DE5\u5177 ")]),_:1})]),default:u(()=>[Yt]),_:1}),e(E,{class:"tittle-dropdown",position:"bl",trigger:"hover","popup-max-height":!1},{content:u(()=>[e(C,{style:{width:"200px"}}),e(C,{class:"w-100",onMousedown:c,onClick:h[1]||(h[1]=O=>t("copy"))},{default:u(()=>[e(b,null,{default:u(()=>[e(w,{flex:"20px"},{default:u(()=>[v(" \u590D\u5236 ")]),_:1}),e(w,{flex:"auto",class:"text-end"},{default:u(()=>[v(" Ctrl + C ")]),_:1})]),_:1})]),_:1}),e(C,{onMousedown:c,onClick:h[2]||(h[2]=O=>t("cut"))},{default:u(()=>[e(b,null,{default:u(()=>[e(w,{flex:"20px"},{default:u(()=>[v(" \u526A\u5207 ")]),_:1}),e(w,{flex:"auto",class:"text-end"},{default:u(()=>[v(" Ctrl + X ")]),_:1})]),_:1})]),_:1}),e(C,{onMousedown:c,onClick:h[3]||(h[3]=O=>t("paste"))},{default:u(()=>[e(b,null,{default:u(()=>[e(w,{flex:"20px"},{default:u(()=>[v(" \u7C98\u8D34 ")]),_:1}),e(w,{flex:"auto",class:"text-end"},{default:u(()=>[v(" Ctrl + V ")]),_:1})]),_:1})]),_:1}),e(C,{onMousedown:c,onClick:h[4]||(h[4]=O=>t("undo"))},{default:u(()=>[e(b,null,{default:u(()=>[e(w,{flex:"20px"},{default:u(()=>[v(" \u4E0A\u4E00\u6B65 ")]),_:1}),e(w,{flex:"auto",class:"text-end"},{default:u(()=>[v(" Ctrl + Z ")]),_:1})]),_:1})]),_:1}),e(C,{onMousedown:c,onClick:h[5]||(h[5]=O=>t("redo"))},{default:u(()=>[e(b,null,{default:u(()=>[e(w,{flex:"20px"},{default:u(()=>[v(" \u4E0B\u4E00\u6B65 ")]),_:1}),e(w,{flex:"auto",class:"text-end"},{default:u(()=>[v(" Ctrl + Y ")]),_:1})]),_:1})]),_:1})]),default:u(()=>[m("span",{class:"title-item",onMousedown:c}," \u7F16\u8F91 ",32)]),_:1}),e(E,{class:"tittle-dropdown",position:"bl",trigger:"hover","popup-max-height":!1},{content:u(()=>[e(C,{style:{width:"200px"},onClick:_(ut)},{default:u(()=>[v(" \u5173\u4E8E\u8F6F\u4EF6 ")]),_:1},8,["onClick"]),e(C,{onClick:r},{default:u(()=>[v(" \u5168\u90E8\u901A\u77E5 ")]),_:1}),e(qe,{title:"\u5B98\u7F51\u6559\u7A0B",url:"https://docs.ocsjs.com/"}),e(qe,{title:"\u8F6F\u4EF6\u66F4\u65B0",url:"https://docs.ocsjs.com/docs/\u8D44\u6E90\u4E0B\u8F7D/app-downloads"})]),default:u(()=>[Kt]),_:1})])}}});var Xt=R(Ht,[["__scopeId","data-v-67b6c290"]]);const Zt=["title"],Gt=j({__name:"Icon",props:{theme:{default:"outlined"},type:null,title:{default:""},active:{type:Boolean},color:{default:void 0},size:{default:void 0}},setup(a){const o=a,t=z("span"),n=He(),{type:s}=we(o);return(r,d)=>(p(),B(je(_(n).default?_(mt):_(t)),null,{default:u(()=>[m("span",{style:Pe({color:a.color,fontSize:a.size?a.size+"px":"inherit"}),class:ke("material-icons"+(a.theme==="filled"?"":"-"+a.theme)),title:a.title},A(_(s)),15,Zt),m("span",null,[K(r.$slots,"default",{},void 0,!0)])]),_:3}))}});var T=R(Gt,[["__scopeId","data-v-5267b39f"]]);const nt=a=>(De("data-v-77cb0220"),a=a(),xe(),a),Qt={class:"d-flex mb-3"},eu=nt(()=>m("span",{class:"col-2"},"\u6807\u7B7E\u540D: ",-1)),tu={style:{float:"right"}},uu={class:"d-flex"},ou=nt(()=>m("span",{class:"col-2"},"\u6807\u7B7E\u989C\u8272: ",-1)),nu=j({__name:"Tags",props:{tags:null,size:{default:"small"},readOnly:{type:Boolean,default:!1}},emits:["update:tags","remove","create"],setup(a,{emit:o}){const t=a,n=Object,s=()=>n.keys(F.browser.tags).map(C=>({value:C,...F.browser.tags[C]})).sort((C,E)=>E.count-C.count),r=L(s()),d=L(),i=N({modalVisible:!1,inputValue:"",color:"gray"}),c=C=>{r.value=s().filter(E=>RegExp(C).test(E.value))},l=C=>{const E=t.tags.filter(w=>w.name!==C.name);o("update:tags",E),o("remove",C)},y=()=>{i.modalVisible=!0,te(()=>{d.value.focus()})},h=()=>{const C=i.inputValue;let E=t.tags;if(C&&E.map(w=>w.name).findIndex(w=>w===C)===-1){const w={name:C,color:i.color};E=[...E,w],o("create",w)}Object.assign(i,{modalVisible:!1,inputValue:"",color:""}),o("update:tags",E)};return(C,E)=>{const w=f("a-tag"),b=f("a-tooltip"),O=f("icon-plus"),P=f("a-space"),x=f("a-auto-complete"),k=f("ColorPicker"),Y=f("a-modal");return p(),g(S,null,[e(b,{content:a.readOnly?"\u6807\u7B7E\u5206\u7C7B":""},{default:u(()=>[a.readOnly===!1||a.tags.length>0?(p(),B(P,{key:0,class:"flex-wrap",size:1},{default:u(()=>[(p(!0),g(S,null,U(a.tags,(V,_e)=>(p(),g(S,{key:_e},[V.name.length>20?(p(),B(b,{key:0,class:"tag",content:V.name},{default:u(()=>[e(w,{closable:!a.readOnly,color:V.color,size:t.size,onClose:Fe=>l(V)},{default:u(()=>[v(A(`${V.name.slice(0,20)}...`),1)]),_:2},1032,["closable","color","size","onClose"])]),_:2},1032,["content"])):(p(),B(w,{key:1,class:"tag",closable:!a.readOnly,color:V.color,size:t.size,onClose:Fe=>l(V)},{default:u(()=>[v(A(V.name),1)]),_:2},1032,["closable","color","size","onClose"]))],64))),128)),a.readOnly?$("",!0):(p(),B(w,{key:0,style:{border:"1px gray","border-style":"dashed",cursor:"pointer"},size:t.size,onClick:y},{default:u(()=>[e(b,{content:"\u6DFB\u52A0\u65B0\u7684\u6807\u7B7E"},{default:u(()=>[e(O)]),_:1})]),_:1},8,["size"]))]),_:1})):$("",!0)]),_:1},8,["content"]),e(Y,{visible:i.modalVisible,"onUpdate:visible":E[3]||(E[3]=V=>i.modalVisible=V),"align-center":"","ok-text":"\u786E\u8BA4","cancel-text":"\u53D6\u6D88",title:"\u6DFB\u52A0\u65B0\u6807\u7B7E",onOk:h},{default:u(()=>[m("div",Qt,[eu,e(x,{ref_key:"inputRef",ref:d,modelValue:i.inputValue,"onUpdate:modelValue":E[0]||(E[0]=V=>i.inputValue=V),placeholder:"\u8F93\u5165\u6807\u7B7E\u540D",size:"small",style:{width:"100%"},options:r.value,onSearch:c},{option:u(({value:V,color:_e,count:Fe})=>[e(w,{color:_e},{default:u(()=>[v(A(V),1)]),_:2},1032,["color"]),m("span",tu,A(Fe),1)]),_:1},8,["modelValue","options"])]),m("div",uu,[ou,_(F).browser.tags[i.inputValue]?(p(),g("div",{key:0,style:Pe([{cursor:"not-allowed",width:"50px"},{backgroundColor:_(F).browser.tags[i.inputValue].color}]),onClick:E[1]||(E[1]=Te(()=>{},["prevent"]))},null,4)):(p(),B(k,{key:1,pureColor:i.color,"onUpdate:pureColor":E[2]||(E[2]=V=>i.color=V)},null,8,["pureColor"]))])]),_:1},8,["visible"])],64)}}});var $e=R(nu,[["__scopeId","data-v-77cb0220"]]);const su=m("div",null," OCS \u7F51\u8BFE\u811A\u672C\u914D\u7F6E\uFF0C\u5C06\u4F1A\u4E0E\u6D4F\u89C8\u5668\u4E2D\u7684\u811A\u672C\u914D\u7F6E\u8FDB\u884C\u540C\u6B65\uFF0C\u5982\u679C\u60A8\u4E0D\u4F7F\u7528OCS\u811A\u672C\uFF0C\u6216\u8005\u4E0D\u60F3\u8FDB\u884C\u540C\u6B65\uFF0C\u53EF\u624B\u52A8\u5173\u95ED\u540C\u6B65\u3002 ",-1),au=m("div",null,"\u4F7F\u7528OCS\u5168\u5C40\u914D\u7F6E\uFF0C\u53EA\u9700\u914D\u7F6E\u5168\u5C40\u6570\u636E\uFF0C\u5219\u53EF\u540C\u6B65\u5230\u6240\u6709\u6D4F\u89C8\u5668\u3002",-1),lu=m("div",null,"\u4E5F\u53EF\u4EE5\u4E3A\u6BCF\u4E2A\u6D4F\u89C8\u5668\u8BBE\u7F6E\u72EC\u7ACB\u7684\u6570\u636E\uFF0C\u4F8B\u5982\uFF1A\u81EA\u52A8\u767B\u5F55\u7684\u624B\u673A\u548C\u5BC6\u7801\u3002",-1),ru=m("div",null," (\u5F00\u542F\u72EC\u7ACB\u914D\u7F6E\u540E\uFF0C\u672A\u7ECF\u8FC7\u4FEE\u6539\u8FC7\u7684\u6570\u636E\u4F9D\u7136\u4F1A\u4F7F\u7528\u5168\u5C40\u914D\u7F6E\uFF0C\u4F8B\u5982\u4FEE\u6539\u4E86\u624B\u673A\u53F7\uFF0C\u4F46\u662F\u5176\u4ED6\u672A\u4FEE\u6539\uFF0C\u5982\u5168\u5C40\u914D\u7F6E\u7684\u500D\u901F\u4E2D\uFF0C\u89C6\u9891\u500D\u901F\u4E3A 16\uFF0C\u90A3\u4E48\u8FD9\u91CC\u7684\u914D\u7F6E\u4E5F\u662F\u4F7F\u7528\u5168\u5C40\u914D\u7F6E\u7684 16 \u500D\u901F\u3002) ",-1),iu=["id"],cu={style:{color:"red"}},du=j({__name:"OCSPanels",props:{browser:null},setup(a){const o=a,t=G.from(o.browser.uid),n=N({root:void 0,css:"",loading:!1,err:"",currentProjectName:"",projects:[],type:Object.keys(t.store).length>0?"override":"global"});console.log({store:t.store}),ie(()=>{s()}),wt(()=>{s()}),ue(()=>[n.currentProjectName,n.type],()=>{n.type==="override"&&te(()=>{var c,l;const d=global.OCS,i=n.projects.find(y=>y.name===n.currentProjectName);if(d.$elements.root.replaceChildren(),d.$.loadCustomElements(d.definedCustomElements),d.$elements.root.append(d.el("style",n.css)),d.$elements.root.append(d.el("style","script-panel-element {box-shadow: none;resize: none;color:#2e2e2e}")),i){for(const y in i.scripts)if(Object.prototype.hasOwnProperty.call(i.scripts,y)){const h=i.scripts[y];if(h.cfg=Object.keys(h.cfg).length===0?d.$.createConfigProxy(h):h.cfg,h.namespace&&h.configs&&h.hideInPanel!==!1){const C=d.$creator.scriptPanel(h,{expandAll:!1,projectName:""});d.$elements.root.append(C);try{(l=(c=h.onrender)==null?void 0:c.call(h,{panel:C,header:d.el("header-element")}))==null||l.catch(E=>{console.error(E)})}catch(E){console.error(E)}}}d.$el(`#ocs-browser-configs-${o.browser.uid}`).replaceChildren(d.$elements.panel),n.root=n.root||d.$elements.root,te(()=>{n.root&&d.$$el("config-element",n.root).forEach(y=>{const h=y,C=Reflect.get(t.store,h.key);C&&(h.provider.value=C),h.addEventListener("change",E=>{Reflect.set(t.store,h.key,h.value)})})})}})});function s(){n.loading=!0,te(async()=>{try{if(global.OCS===void 0){const i=await D.methods.call("get","https://cdn.ocsjs.com/index.js");await D.webContents.call("executeJavaScript",i)}n.css===""&&(n.css=await D.methods.call("get","https://cdn.ocsjs.com/style.css"));const d=global.OCS;n.projects=d.definedProjects().sort(({level:i=0},{level:c=0})=>c-i),n.currentProjectName=n.projects[0].name}catch(d){n.err=String(d)}n.loading=!1})}function r(){t.store={},M.success(`\u5DF2\u91CD\u7F6E ${t.name} \u914D\u7F6E`)}return(d,i)=>{const c=f("a-divider"),l=f("a-option"),y=f("a-select"),h=f("a-tooltip"),C=f("a-button"),E=f("a-space"),w=f("icon-loading");return p(),g(S,null,[le(m("div",null,[e(E,{class:"mb-3"},{default:u(()=>[e(h,null,{content:u(()=>[su,au,lu,e(c,{class:"mt-1 mb-1"}),ru]),default:u(()=>[e(y,{modelValue:n.type,"onUpdate:modelValue":i[0]||(i[0]=b=>n.type=b),size:"mini"},{default:u(()=>[e(l,{value:"global"},{default:u(()=>[v(" \u4F7F\u7528\u5168\u5C40\u914D\u7F6E ")]),_:1}),e(l,{value:"override"},{default:u(()=>[v(" \u4F7F\u7528\u72EC\u7ACB\u914D\u7F6E ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),n.type==="override"?(p(),B(h,{key:0,content:"\u6062\u590D\u9ED8\u8BA4\u7684\u914D\u7F6E\u6570\u636E"},{default:u(()=>[Object.keys(_(t).store).length!==0?(p(),B(C,{key:0,size:"mini",onClick:r},{default:u(()=>[v(" \u91CD\u7F6E\u914D\u7F6E ")]),_:1})):$("",!0)]),_:1})):$("",!0)]),_:1}),n.type==="override"?(p(),g(S,{key:0},[e(y,{modelValue:n.currentProjectName,"onUpdate:modelValue":i[1]||(i[1]=b=>n.currentProjectName=b)},{default:u(()=>[(p(!0),g(S,null,U(n.projects,b=>(p(),B(l,{key:b.name,value:b.name},{default:u(()=>[v(A(b.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),m("div",{id:"ocs-browser-configs-"+_(t).uid,class:"p-3"},null,8,iu)],64)):$("",!0)],512),[[re,n.loading===!1]]),le(m("div",cu," \u89E3\u6790\u9519\u8BEF\uFF01 ",512),[[re,n.loading===!1&&n.err!==""]]),le(m("div",null,[e(w),v(" \u6B63\u5728\u83B7\u53D6\u6700\u65B0OCS\u914D\u7F6E")],512),[[re,n.loading===!0&&n.err===""]])],64)}}});const pu={id:"bp-tags","data-label":"\u6807\u7B7E\u5206\u7C7B"},_u={id:"bp-ocs-config","data-label":"OCS\u914D\u7F6E"},fu={class:"m-3",style:{height:"70vh",overflow:"overlay"}},mu={id:"bp-file-history","data-label":"\u64CD\u4F5C\u5386\u53F2",class:"histories"},Fu={class:"text-secondary",style:{"font-size":"12px"}},hu={key:0},yu=j({__name:"BrowserPanel",props:{browser:null},setup(a){const o=a,t=G.from(o.browser.uid),n=L(),s=N({showCode:!1});function r(c){var l;F.render.browser.tags[c.name]?F.render.browser.tags[c.name].count+=1:(F.render.browser.tags[c.name]={color:c.color,count:1},(l=se.value)==null||l.histories.unshift({action:"\u6DFB\u52A0\u6807\u7B7E",content:c.name,time:Date.now()}))}function d(c){var l;F.render.browser.tags[c.name]&&F.render.browser.tags[c.name].count>1?F.render.browser.tags[c.name].count-=1:Reflect.deleteProperty(F.render.browser.tags,c.name),(l=se.value)==null||l.histories.unshift({action:"\u5220\u9664\u6807\u7B7E",content:c.name,time:Date.now()})}function i(){se.value&&(se.value.histories=[])}return ie(()=>{te(()=>{const c=Array.from(document.querySelectorAll("[id^=bp-]"));console.log(c);const l=document.createElement("div");l.classList.add("bp-toc");const y=document.querySelector("#browser-panel"),h=document.querySelector("#browser-panel .arco-drawer");if(y&&h){y.prepend(l),l.style.right=h.clientWidth+"px";for(const C of c){const E=document.createElement("div");E.textContent=C.dataset.label||"",E.addEventListener("click",()=>{C.scrollIntoView()}),l.append(E)}}})}),(c,l)=>{const y=f("a-descriptions-item"),h=f("a-button"),C=f("a-descriptions"),E=f("a-divider"),w=f("a-textarea"),b=f("a-modal"),O=f("a-timeline-item"),P=f("a-timeline"),x=f("a-empty");return p(),g("div",{ref_key:"profileElement",ref:n,class:"overflow-auto profile pt-2"},[e(C,{column:1},{default:u(()=>[e(y,{label:"\u6587\u4EF6\u540D"},{default:u(()=>[v(A(a.browser.name),1)]),_:1}),e(y,{label:"\u521B\u5EFA\u65F6\u95F4"},{default:u(()=>[v(A(_(Ne)(a.browser.createTime)),1)]),_:1}),e(y,{label:"\u6587\u4EF6\u4F4D\u7F6E"},{default:u(()=>{var k;return[v(A((k=_(X).from(a.browser.parent))==null?void 0:k.flatParents().map(Y=>Y.name).join(" / "))+" ",1),e(h,{type:"text",onClick:l[0]||(l[0]=Y=>{var V;return(V=_(t))==null?void 0:V.location()})},{default:u(()=>[v(" \u8DF3\u8F6C\u5230\u8BE5\u76EE\u5F55 ")]),_:1})]}),_:1}),e(y,{label:"\u7F13\u5B58\u8DEF\u5F84"},{default:u(()=>[v(A(a.browser.cachePath),1)]),_:1})]),_:1}),e(E),_(t)?(p(),B(C,{key:0,column:1,size:"large"},{default:u(()=>[e(y,{label:"\u6807\u7B7E\u5206\u7C7B"},{default:u(()=>[m("div",pu,[e($e,{tags:_(t).tags,"onUpdate:tags":l[1]||(l[1]=k=>_(t).tags=k),size:"small",onCreate:r,onRemove:d},null,8,["tags"])])]),_:1}),e(y,{label:"\u5907\u6CE8\u63CF\u8FF0"},{default:u(()=>[e(w,{id:"bp-notes",modelValue:_(t).notes,"onUpdate:modelValue":l[2]||(l[2]=k=>_(t).notes=k),"data-label":"\u5907\u6CE8\u63CF\u8FF0",placeholder:"\u5907\u6CE8\u4E3A\u7A7A~","auto-size":{minRows:2,maxRows:10},"allow-clear":""},null,8,["modelValue"])]),_:1}),e(y,{label:"OCS\u914D\u7F6E"},{default:u(()=>[m("div",_u,[e(du,{browser:_(t)},null,8,["browser"])])]),_:1}),e(y,{label:"\u6587\u4EF6\u6570\u636E"},{default:u(()=>[e(h,{id:"bp-file-data","data-label":"\u6587\u4EF6\u6570\u636E",size:"mini",onClick:l[3]||(l[3]=k=>s.showCode=!0)},{default:u(()=>[v(" \u70B9\u51FB\u67E5\u770B ")]),_:1}),e(b,{visible:s.showCode,"onUpdate:visible":l[4]||(l[4]=k=>s.showCode=k),footer:!1,simple:!0,width:600,"modal-class":"p-0 m-0"},{default:u(()=>[m("div",fu,[e(w,{"auto-size":!0,disabled:!0,"model-value":JSON.stringify(_(t),null,4)},null,8,["model-value"])])]),_:1},8,["visible"])]),_:1}),e(y,{label:"\u64CD\u4F5C\u5386\u53F2"},{default:u(()=>[m("div",mu,[a.browser.histories.length?(p(),g(S,{key:0},[e(h,{size:"mini",class:"mb-2"},{default:u(()=>[e(T,{type:"delete",onClick:i},{default:u(()=>[v(" \u6E05\u7A7A ")]),_:1})]),_:1}),e(P,null,{default:u(()=>[(p(!0),g(S,null,U(a.browser.histories,(k,Y)=>(p(),B(O,{key:Y},{default:u(()=>[m("p",Fu,A(_(Ne)(k.time)),1),m("p",null,[m("span",null,A(k.action),1),k.content?(p(),g("span",hu,": "+A(k.content),1)):$("",!0)])]),_:2},1024))),128))]),_:1})],64)):(p(),B(x,{key:1}))])]),_:1})]),_:1})):$("",!0)],512)}}});var vu=R(yu,[["__scopeId","data-v-9b9d7e4c"]]);async function st(a,o){a.filter(t=>t.installed).length>0?M.warning("\u811A\u672C\u7BA1\u7406\u5668\u5DF2\u7ECF\u5B58\u5728\uFF0C\u8BF7\u5378\u8F7D\u53E6\u5916\u4E00\u4E2A\u518D\u5C1D\u8BD5\u5B89\u88C5\u3002"):(await Nt({name:o.name,filename:o.name,folder:F.paths.extensionsFolder,url:o.url}),o.installed=!0,fe.confirm({title:"\u63D0\u793A",content:"\u5B89\u88C5\u811A\u672C\u7BA1\u7406\u5668\u540E\u9700\u8981\u91CD\u542F\u624D\u80FD\u751F\u6548\u3002",okText:"\u7ACB\u523B\u91CD\u542F",cancelText:"\u7A0D\u7B49\u81EA\u884C\u91CD\u542F",onOk:async()=>{await D.app.call("relaunch"),await D.app.call("exit",0)}}))}function Je(a){const o=a.target.files[0];o.path.endsWith(".user.js")?D.fs.call("statSync",o.path).then(async t=>{const n=await D.fs.call("readFileSync",o.path,{encoding:"utf8"});at(o.path,n.toString())}).catch(t=>{M.error("\u6587\u4EF6\u8BFB\u53D6\u5931\u8D25 : "+t.message)}):M.error("\u7528\u6237\u811A\u672C\u5FC5\u987B\u4EE5 .user.js \u4F5C\u4E3A\u6587\u4EF6\u540E\u7F00"),a.target.value=""}function at(a,o){var r;const t=((r=o.match(/\/\/\s+==UserScript==([\s\S]+)\/\/\s+==\/UserScript==/))==null?void 0:r[1])||"",n=(t.match(/\/\/\s+@(.+?)\s+(.*?)(?:\n|$)/g)||[]).map(d=>{const i=d.match(/[\S]+/g)||[];return{key:(i[1]||"").replace("@",""),value:i.slice(2).join(" ")}}),s=d=>n.filter(i=>i.key===d).map(i=>i.value);if(t==="")M.error("\u811A\u672C\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u9009\u62E9\u80FD\u591F\u89E3\u6790\u7684\u7528\u6237\u811A\u672C\u3002");else if(F.render.scripts.find(d=>d.url===a))M.warning("\u5F53\u524D\u811A\u672C\u5DF2\u5B89\u88C5\u3002");else{const d=Date.now();F.render.scripts.push({id:d,url:a,enable:!0,info:{id:d,url:a,authors:s("author").map(i=>({name:i,url:""}))||[],description:s("description")[0],license:s("license")[0],name:"\u3010\u672C\u5730\u811A\u672C\u3011"+s("name")[0],version:s("version")[0],code_url:a,ratings:0,total_installs:0,daily_installs:0,createTime:0,updateTime:0}})}}async function Eu(a){const o=await D.path.call("join",F.paths.downloadFolder,"./scripts");await D.fs.call("existsSync",o)||await D.fs.call("mkdirSync",o);const t=await D.path.call("join",o,a.url.split("/").at(-1)||"script.js");await tt({name:a.name,dest:t,url:a.url});const n=await D.fs.call("readFileSync",t,{encoding:"utf8"});at(t,n.toString())}const wu=m("div",null," \u521D\u59CB\u5316\u60A8\u7684\u8F6F\u4EF6\u8BBE\u7F6E\uFF0C\u5982\u679C\u4E0D\u6EE1\u610F\u5B98\u65B9\u63D0\u4F9B\u7684\u8BBE\u7F6E\uFF0C\u53EF\u7A0D\u540E\u81EA\u884C\u5728\u8F6F\u4EF6\u5DE6\u4FA7\u7684\u5404\u680F\u4E2D\u624B\u52A8\u8BBE\u7F6E\uFF0C\u8BBE\u7F6E\u5B8C\u6210\u540E\u5373\u53EF\u521B\u5EFA\u6D4F\u89C8\u5668\u8FDB\u884C\u7F51\u8BFE\u5B66\u4E60\u3002 ",-1),Cu=m("div",null,"\u5982\u679C\u60F3\u91CD\u65B0\u6253\u5F00\u6B64\u7A97\u53E3\uFF1A \u5DE6\u4E0A\u89D2 -> \u5DE5\u5177 -> \u521D\u59CB\u5316\u8BBE\u7F6E",-1),gu=m("div",null,"OCS\u8F6F\u4EF6\u9700\u8981\u4F7F\u7528\u6D4F\u89C8\u5668\u8FDB\u884C\u64CD\u4F5C\uFF0C\u7CFB\u7EDF\u4F1A\u81EA\u52A8\u68C0\u6D4B\u60A8\u7535\u8111\u4E0A\u5B58\u5728\u7684\u6D4F\u89C8\u5668",-1),bu=m("div",null,"\u5982\u679C\u6CA1\u6709\uFF0C\u8BF7\u7A0D\u540E\u5728\u8F6F\u4EF6\u5DE6\u4FA7\u7684\u8BBE\u7F6E\u4E2D\uFF0C\u8BBE\u7F6E\u5177\u4F53\u8DEF\u5F84\u3002",-1),Bu=m("span",null," \u6D4F\u89C8\u5668 ",-1),Du=m("span",null," \u811A\u672C\u7BA1\u7406\u5668 ",-1),xu=m("span",null," \u7F51\u8BFE\u811A\u672C ",-1),ku=j({__name:"Setup",setup(a){const o=N({resource:{browsers:[],extensions:[],ocsjs:""},browser:"",downloadPath:"",extension:"",loading:!1,error:!1,downloading:""});ie(async()=>{o.loading=!0;try{const d=await Ae();o.resource.browsers=await D.methods.call("getValidBrowsers"),o.browser=o.resource.browsers[0].name,o.resource.extensions=d.extensions,o.resource.ocsjs=d.resource.userjs,o.downloadPath=await D.path.call("join",F.paths.downloadFolder);for(const i of o.resource.extensions)i.installed=await D.fs.call("existsSync",`${F.paths.extensionsFolder}/${i.name}`);o.extension=o.resource.extensions[0].name}catch(d){o.error=!0,M.error(String(d))}finally{o.loading=!1}});async function t(d){o.downloading=`\u6B63\u5728\u4E0B\u8F7D\u811A\u672C\u7BA1\u7406\u5668 : ${d.name} ...`,await st(o.resource.extensions,d)}async function n(){const d="OCS \u7F51\u8BFE\u52A9\u624B";o.downloading=`\u6B63\u5728\u4E0B\u8F7D\u811A\u672C : ${d} ...`,await Eu({url:o.resource.ocsjs,name:d})}function s(){F.render.state.setup=!1}async function r(){const d=o.resource.browsers.find(c=>c.name===o.browser),i=o.resource.extensions.find(c=>c.name===o.extension);if(d&&i)try{F.render.setting.launchOptions.executablePath=d.path,await n(),await t(i)}catch(c){M.error("\u5B89\u88C5\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5\uFF0C\u6216\u8005\u624B\u52A8\u8BBE\u7F6E : "+c)}else M.error("\u53C2\u6570\u9519\u8BEF");o.downloading="",F.render.state.setup=!1}return(d,i)=>{const c=f("a-col"),l=f("icon-loading"),y=f("a-empty"),h=f("a-tooltip"),C=f("a-option"),E=f("a-select"),w=f("a-row"),b=f("a-button"),O=f("a-space");return p(),B(w,{gutter:[24,24]},{default:u(()=>[e(c,{class:"text-secondary",style:{"font-size":"12px"}},{default:u(()=>[wu,Cu]),_:1}),o.loading?(p(),B(c,{key:0,class:"text-center"},{default:u(()=>[e(l)]),_:1})):o.error?(p(),B(y,{key:1,description:"\u8D44\u6E90\u8BF7\u6C42\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5\u3002"})):o.downloading?(p(),B(c,{key:2,class:"text-center"},{default:u(()=>[e(l),v(" "+A(o.downloading),1)]),_:1})):(p(),g(S,{key:3},[e(c,null,{default:u(()=>[e(w,{class:"flex-nowrap align-items-center"},{default:u(()=>[e(c,{flex:"100px"},{default:u(()=>[e(h,null,{content:u(()=>[gu,bu]),default:u(()=>[e(T,{type:"help_outline"})]),_:1}),Bu]),_:1}),e(c,{flex:"auto"},{default:u(()=>[e(w,{gutter:[0,12]},{default:u(()=>[e(c,null,{default:u(()=>[e(E,{modelValue:o.browser,"onUpdate:modelValue":i[0]||(i[0]=P=>o.browser=P),placeholder:"\u672A\u68C0\u6D4B\u5230\u53EF\u7528\u6D4F\u89C8\u5668\uFF0C\u8BF7\u7A0D\u540E\u5728\u5DE6\u4FA7\u8F6F\u4EF6\u8BBE\u7F6E\u4E2D\u8BBE\u7F6E\u3002",disabled:o.resource.browsers.length===0},{default:u(()=>[(p(!0),g(S,null,U(o.resource.browsers,P=>(p(),B(C,{key:P.name,value:P.name,label:P.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(c,null,{default:u(()=>[e(w,{class:"flex-nowrap align-items-center"},{default:u(()=>[e(c,{flex:"100px"},{default:u(()=>[e(h,{content:"\u6D4F\u89C8\u5668\u6253\u5F00\u540E\u53EF\u7528\u4F7F\u7528\u811A\u672C\u7BA1\u7406\u5668\u8FDB\u884C\u811A\u672C\u7684\uFF1A\u5B89\u88C5\uFF0C\u8FD0\u884C\uFF0C\u5220\u9664 \u7B49\u64CD\u4F5C"},{default:u(()=>[e(T,{type:"help_outline"})]),_:1}),Du]),_:1}),e(c,{flex:"auto"},{default:u(()=>[e(E,{modelValue:o.extension,"onUpdate:modelValue":i[1]||(i[1]=P=>o.extension=P)},{default:u(()=>[(p(!0),g(S,null,U(o.resource.extensions,P=>(p(),B(C,{key:P.name,label:P.name},null,8,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,null,{default:u(()=>[e(w,{class:"flex-nowrap align-items-center"},{default:u(()=>[e(c,{flex:"100px"},{default:u(()=>[e(h,{content:"\u5B89\u88C5\u7F51\u8BFE\u811A\u672C\u8FDB\u884C\u8BFE\u7A0B\u7684\u89C2\u770B\u548C\u5B66\u4E60"},{default:u(()=>[e(T,{type:"help_outline"})]),_:1}),xu]),_:1}),e(c,{flex:"auto"},{default:u(()=>[e(E,{"default-value":"OCS \u7F51\u8BFE\u52A9\u624B"})]),_:1})]),_:1})]),_:1})],64)),e(c,{class:"text-center mt-5"},{default:u(()=>[e(O,{size:24},{default:u(()=>[e(b,{size:"small",disabled:!!o.downloading,onClick:s},{default:u(()=>[v(" \u7A0D\u7B49\u624B\u52A8\u8BBE\u7F6E ")]),_:1},8,["disabled"]),e(b,{type:"primary",size:"small",disabled:o.error||!!o.downloading,onClick:r},{default:u(()=>[v(" \u4E00\u952E\u521D\u59CB\u5316 ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})}}});const Au={class:"row h-100 w-100 p-0 m-0"},$u={class:"col-auto border-end sider h-100"},Su={class:"sider-items"},Ou=["onClick"],Vu={class:"text-secondary version"},zu={class:"col p-0 m-0"},ju={class:"row main h-100 w-100 p-0 m-0"},Pu={class:"col-12 p-0 m-0"},Tu={class:"col-12 p-0 m-0 overflow-auto"},Iu=j({__name:"index",setup(a){const{ipcRenderer:o}=oe,t=L(""),n=bt().currentRoute;Me(()=>s(!1)),o.on("close",()=>s(!0)),ie(async()=>{pe&&(F.render.state.setup=!1,fe.warning({content:"\u4E0B\u8F7D\u684C\u9762\u7248\u8F6F\u4EF6\u624D\u80FD\u4F53\u9A8C\u5168\u90E8\u529F\u80FD\uFF01",title:"\u8B66\u544A",simple:!0,hideCancel:!1,okText:"\u524D\u5F80\u5B98\u7F51\u4E0B\u8F7D",onOk(){window.open("https://docs.ocsjs.com/docs/\u8D44\u6E90\u4E0B\u8F7D/app-downloads","_blank")}})),D.app.call("getVersion").then(i=>{t.value=i}),D.win.call("setTitle",`OCS - ${me.resolve(n.value).meta.title}`),D.logger.call("info","render store init"),Ge(),Qe(),Rt(),te(()=>{F.render.state.first&&ut(),d(),window.addEventListener("resize",d),et(!1),o.on("download",(i,c,l,y,h)=>{c==="update"&&Q("OCS\u66F4\u65B0\u7A0B\u5E8F",`\u66F4\u65B0\u4E2D: ${(h/1024/1024).toFixed(2)}MB/${(y/1024/1024).toFixed(2)}MB`,"updater",{type:"info",duration:5,close:!1})})})}),Me(()=>{o.removeAllListeners("download")});async function s(i){q.length?(await D.win.call("moveTop"),fe.warning({content:"\u8FD8\u6709\u6D4F\u89C8\u5668\u6B63\u5728\u8FD0\u884C\uFF0C\u60A8\u786E\u5B9A\u5173\u95ED\u8F6F\u4EF6\u5417\uFF1F",title:"\u8B66\u544A",maskClosable:!0,closable:!0,alignCenter:!0,hideCancel:!1,onOk:async()=>{const c=fe.info({content:"\u6B63\u5728\u5173\u95ED\u6240\u6709\u6D4F\u89C8\u5668...",closable:!1,maskClosable:!1,footer:!1});setTimeout(()=>{i&&D.app.call("exit"),c.close()},5e3);try{for(const l of q)await l.close(),await Lt(100)}catch{}}})):i&&D.app.call("exit")}function r(i){me.push(i.path),D.win.call("setTitle",`OCS - ${i.meta.title}`)}function d(){const i=document.documentElement.clientWidth<1200;F.render.state.mini=i,F.render.state.responsive=i?"mini":"small"}return(i,c)=>{const l=f("a-tooltip"),y=f("router-view"),h=f("a-drawer"),C=f("a-modal"),E=f("a-config-provider");return p(),B(E,{locale:_(Ft)},{default:u(()=>{var w;return[m("div",Au,[m("div",$u,[m("div",Su,[(p(!0),g(S,null,U(((w=_(it).find(b=>b.name==="index"))==null?void 0:w.children)||[],(b,O)=>(p(),g("div",{key:O,class:"sider-item",onClick:P=>r(b)},[e(l,{content:b.meta.title,position:"right"},{default:u(()=>[e(T,{class:"icon",type:b.meta.icon,theme:b.path===_(n).path?"filled":"outlined"},null,8,["type","theme"])]),_:2},1032,["content"])],8,Ou))),128))]),m("div",Vu,A(t.value),1)]),m("div",zu,[m("div",ju,[m("div",Pu,[e(Xt,{id:"title"})]),m("div",Tu,[e(y,null,{default:u(({Component:b})=>[(p(),B(Ke,null,[(p(),B(je(b)))],1024))]),_:1})])])])]),_(se)?(p(),B(h,{key:0,id:"browser-panel",closable:!1,visible:!!_(se),width:600,footer:!1,header:!1,onCancel:c[0]||(c[0]=b=>_(F).render.browser.currentBrowserUid="")},{default:u(()=>[e(vu,{browser:_(se)},null,8,["browser"])]),_:1},8,["visible"])):$("",!0),_(F).render.state.setup?(p(),B(C,{key:1,visible:!0,footer:!1,"mask-closable":!1},{title:u(()=>[v(" \u521D\u59CB\u5316\u8F6F\u4EF6\u8BBE\u7F6E ")]),default:u(()=>[e(ku)]),_:1})):$("",!0)]}),_:1},8,["locale"])}}});const Ie=a=>(De("data-v-8c091e6a"),a=a(),xe(),a),Mu={class:"bookmarks"},Ru=Ie(()=>m("h1",null,"OCS \u5BFC\u822A\u9875",-1)),Uu=Ie(()=>m("div",{class:"bookmarks-blockquote text-secondary mb-3",style:{"font-size":"14px"}},[m("div",null,"\u8FDB\u5165\u6D4F\u89C8\u5668\u5E76\u7B49\u5F85\u521D\u59CB\u5316\u540E\uFF0C\u5373\u53EF\u4F7F\u7528\u5B89\u88C5\u7684\u6D4F\u89C8\u5668\u811A\u672C\u7BA1\u7406\u62D3\u5C55\uFF0C\u8FDB\u884C\u811A\u672C\u7684\u8FD0\u884C\u3002"),m("div",null,"\u5982\u679C\u60A8\u4F7F\u7528\u7684\u662F \u201COCS \u7F51\u8BFE\u52A9\u624B\u201D\uFF0C\u8BF7\u6253\u5F00\u4EE5\u4E0B\u4EFB\u610F\u4E00\u4E2A\u7F51\u8BFE\u5E73\u53F0\u5373\u53EF\uFF0C\u4F1A\u51FA\u73B0\u811A\u672C\u60AC\u6D6E\u7A97\uFF0C\u5E76\u6709\u5BF9\u5E94\u7684\u4F7F\u7528\u6559\u7A0B\u3002")],-1)),Lu={class:"bookmark-card-body"},Nu=["href"],qu={class:"icon col-12"},Ju=["src"],Wu=["data"],Yu=Ie(()=>m("img",{src:"https://fonts.gstatic.com/s/i/materialiconsoutlined/public/v13/24px.svg"},null,-1)),Ku=[Yu],Hu={class:"col-12 mt-1 text-black text-decoration-underline"},Xu=j({__name:"bookmarks",setup(a){const o=L([]),t=N({loading:!1,tip:"\u6D4F\u89C8\u5668\u521D\u59CB\u5316..."});return window.setBookmarkLoadingState=n=>{Object.assign(t,n)},ie(async()=>{const n=await Ae();for(let s=0;s<n.bookmark.length;s++){const r=n.bookmark[s];r.values.forEach(async(d,i)=>{var y,h,C;const c=N(r.values[i]),l=new URL(c.url);c.favicon=`${l.origin}/favicon.ico`,o.value[s]=o.value[s]||{group:"",values:[]},o.value[s].group=r.group,o.value[s].values[i]=c;try{const{data:E}=await Ze.post(`http://localhost:${15319}/proxy`,{method:"get",url:c.url}),w=String(E);c.title=((y=w.match(/<title>(.+?)<\/title>/))==null?void 0:y[1])||"",c.description=((h=w.match(/<meta.+?name="description".+?content="(.+?)".+?>/))==null?void 0:h[1])||"";const b=((C=w.match(/<link.+?rel="icon".+?href="(.+?)".+?>/))==null?void 0:C[1])||"";c.icon=b?b.startsWith("http")?b:b.startsWith("//")?`${c.url.startsWith("https")?"https":"http"}:${b}`:b.startsWith("/")?`${l.origin}${b}`:`${l.origin}/${b}`:""}catch(E){console.error(E)}})}}),(n,s)=>{const r=f("a-divider"),d=f("a-tooltip"),i=f("a-spin");return p(),g("div",Mu,[e(i,{class:"w-100 h-100 p-3",loading:t.loading,tip:t.tip},{default:u(()=>[Ru,Uu,(p(!0),g(S,null,U(o.value,c=>(p(),g(S,{key:c==null?void 0:c.group},[c?(p(),B(_(ht),{key:0,class:"bookmarks-card rounded shadow-sm p-0",bordered:!1,title:c.group},{default:u(()=>[m("div",Lu,[(p(!0),g(S,null,U(c.values,l=>(p(),g("div",{key:l==null?void 0:l.name,class:"bookmark"},[l?(p(),g("a",{key:0,href:l.url,target:"_blank"},[e(d,{"background-color":"#6c6c6ccf"},{content:u(()=>[m("div",null,A(l.title),1),l.description?(p(),g(S,{key:0},[e(r,{class:"m-1"}),m("div",null,A(l.description),1)],64)):$("",!0)]),default:u(()=>[m("div",qu,[l.icon?(p(),g("img",{key:0,src:l.icon},null,8,Ju)):(p(),g("object",{key:1,data:l.favicon,type:"image/png"},Ku,8,Wu))])]),_:2},1024),m("div",Hu,A(l.name),1)],8,Nu)):$("",!0)]))),128))])]),_:2},1032,["title"])):$("",!0)],64))),128))]),_:1},8,["loading","tip"])])}}});var Zu=R(Xu,[["__scopeId","data-v-8c091e6a"]]);const Gu={class:"text-start"},Qu={class:"rounded pt-1"},eo={key:0,class:"mb-2 title fw-bold border-bottom"},to=j({__name:"Card",props:{title:{default:""},badge:{default:"gray"}},setup(a){const o=a,{title:t}=we(o);return(n,s)=>(p(),g("div",Gu,[m("div",Qu,[_(t)?(p(),g("p",eo,A(_(t)),1)):$("",!0),K(n.$slots,"default",{},void 0,!0)])]))}});var Oe=R(to,[["__scopeId","data-v-ac97657e"]]);const uo={class:"row flex-nowrap mb-1"},oo={class:"col-3 desc-label"},no={class:"col-9 d-inline-flex align-items-center"},so=j({__name:"Description",props:{label:null,desc:{default:""},textClass:{default:""}},setup(a){const o=a,{label:t,desc:n,textClass:s}=we(o);return(r,d)=>(p(),g("span",uo,[m("span",oo,A(_(t))+" : ",1),m("span",no,[_(n)?(p(),g("span",{key:0,class:ke(["desc",_(s)])},A(String(_(n))),3)):$("",!0),K(r.$slots,"default",{},void 0,!0)])]))}});var he=R(so,[["__scopeId","data-v-7d8a0338"]]);const Ce=j({__name:"Path",props:{name:null,label:null,setting:{type:Boolean,default:!1}},setup(a){const o=a,{label:t,name:n,setting:s}=we(o),{shell:r}=oe,d=L("");ie(async()=>{d.value=F.paths[n.value]?await D.path.call("resolve",F.paths[n.value]):"\u65E0"});async function i(c){if(s.value){const l=await D.dialog.call("showOpenDialogSync",{properties:["openDirectory"],defaultPath:d.value});l&&(d.value=l[0],F[c]=l[0])}}return(c,l)=>(p(),g("div",null,[e(he,{label:_(t),desc:d.value,"text-class":"pointer",onClick:l[1]||(l[1]=y=>_(r).showItemInFolder(d.value))},{default:u(()=>[_(s)?(p(),B(T,{key:0,class:"ms-3",type:"settings",onClick:l[0]||(l[0]=Te(y=>i(_(n)),["stop"]))})):$("",!0)]),_:1},8,["label","desc"])]))}}),ao=m("b",null,"\u6D4F\u89C8\u5668\u8DEF\u5F84\u83B7\u53D6\u65B9\u5F0F",-1),lo=m("div",null,[m("b",null,"\u8C37\u6B4C\u6D4F\u89C8\u5668"),v(" : \u6253\u5F00\u8C37\u6B4C\u6D4F\u89C8\u5668 "),m("br"),v(" \u8BBF\u95EE "),m("b",null,"chrome://version"),v(" \u627E\u5230 "),m("b",null,"\u53EF\u6267\u884C\u6587\u4EF6\u8DEF\u5F84"),v(" \u590D\u5236\u7C98\u8D34\u5373\u53EF ")],-1),ro=m("div",null,[m("b",null,"Edge\u6D4F\u89C8\u5668"),v(" : \u6253\u5F00Edge\u6D4F\u89C8\u5668"),m("br"),v(" \u8BBF\u95EE "),m("b",null,"edge://version"),v(" \u627E\u5230 "),m("b",null,"\u53EF\u6267\u884C\u6587\u4EF6\u8DEF\u5F84"),v(" \u590D\u5236\u7C98\u8D34\u5373\u53EF ")],-1),io=j({__name:"BrowserPath",setup(a){const o=F.render.setting.launchOptions;async function t(){o.executablePath&&(await D.fs.call("existsSync",o.executablePath)?M.success("\u914D\u7F6E\u6D4F\u89C8\u5668\u8DEF\u5F84\u6210\u529F"):M.error("\u6D4F\u89C8\u5668\u8DEF\u5F84\u4E0D\u5B58\u5728, \u8BF7\u70B9\u51FB\u53F3\u4FA7\u6309\u94AE\u67E5\u770B\u6559\u7A0B\u3002"))}return(n,s)=>{const r=f("a-popover"),d=f("a-input");return p(),B(he,{label:"\u6D4F\u89C8\u5668\u8DEF\u5F84"},{default:u(()=>[e(d,{modelValue:_(o).executablePath,"onUpdate:modelValue":s[0]||(s[0]=i=>_(o).executablePath=i),size:"small",class:"w-100",onBlur:t},{suffix:u(()=>[e(r,null,{title:u(()=>[ao]),content:u(()=>[lo,ro]),default:u(()=>[e(T,{type:"help_outline"})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}});const co={class:"w-100"},po={class:"setting text-center p-2 col-12 col-md-10 col-lg-8"},_o={class:"mt-4"},fo=j({__name:"index",setup(a){async function o(){F.version=void 0,D.app.call("relaunch"),D.app.call("exit",0)}return(t,n)=>{const s=f("a-switch"),r=f("a-button"),d=f("a-popconfirm");return p(),g("div",co,[m("div",po,[e(Oe,{title:"\u57FA\u672C\u8BBE\u7F6E"},{default:u(()=>[e(he,{label:"\u5F00\u673A\u81EA\u542F"},{default:u(()=>[e(s,{modelValue:_(F)["auto-launch"],"onUpdate:modelValue":n[0]||(n[0]=i=>_(F)["auto-launch"]=i),size:"small"},null,8,["modelValue"])]),_:1}),e(he,{label:"\u7A97\u53E3\u7F6E\u9876"},{default:u(()=>[e(s,{modelValue:_(F).render.setting.window.alwaysOnTop,"onUpdate:modelValue":n[1]||(n[1]=i=>_(F).render.setting.window.alwaysOnTop=i),size:"small"},null,8,["modelValue"])]),_:1}),e(he,{label:"\u591C\u95F4\u6A21\u5F0F"},{default:u(()=>[e(s,{modelValue:_(F).render.setting.theme.dark,"onUpdate:modelValue":n[2]||(n[2]=i=>_(F).render.setting.theme.dark=i),size:"small"},null,8,["modelValue"])]),_:1})]),_:1}),e(Oe,{title:"\u9ED8\u8BA4\u8BBE\u7F6E"},{default:u(()=>[e(io)]),_:1}),e(Oe,{title:"\u8DEF\u5F84\u8BBE\u7F6E"},{default:u(()=>[e(Ce,{label:"\u6D4F\u89C8\u5668\u7F13\u5B58\u8DEF\u5F84",name:"userDataDirsFolder",setting:!0}),e(Ce,{label:"\u6D4F\u89C8\u5668\u62D3\u5C55\u8DEF\u5F84",name:"extensionsFolder",setting:!0}),e(Ce,{label:"\u6587\u4EF6\u4E0B\u8F7D\u8DEF\u5F84",name:"downloadFolder",setting:!0}),e(Ce,{label:"\u914D\u7F6E\u6587\u4EF6",name:"config-path"})]),_:1}),m("div",_o,[e(d,{content:"\u786E\u8BA4\u91CD\u7F6E\u60A8\u7684\u8BBE\u7F6E\uFF0C\u5E76\u91CD\u65B0\u542F\u52A8\u8F6F\u4EF6\u5417\uFF1F","ok-text":"\u786E\u8BA4","cancel-text":"\u53D6\u6D88",onOk:o},{default:u(()=>[e(r,{size:"small",status:"danger"},{default:u(()=>[v(" \u91CD\u7F6E\u8BBE\u7F6E ")]),_:1})]),_:1})])])])}}});var mo=R(fo,[["__scopeId","data-v-3ab8f284"]]);const Fo=j({__name:"Entity",props:{entity:null,widths:{default:()=>({name:160,actions:"auto"})}},setup(a){const o=a,t=He(),n=L(),s=L(o.entity.name),r=o.entity.type==="browser"?G.from(o.entity.uid):X.from(o.entity.uid);ue(()=>o.entity.renaming,()=>{o.entity.renaming&&te(d)}),ie(()=>{te(d)});function d(){const i=n.value.$el.querySelector("input");i.focus(),i.select()}return(i,c)=>{const l=f("a-col"),y=f("a-input"),h=f("a-divider"),C=f("a-space"),E=f("a-row");return _(r)?(p(),B(E,{key:0,class:ke(["entity align-items-center",{active:_(F).browser.currentBrowserUid===_(r).uid}])},{default:u(()=>[K(i.$slots,"prefix",{},void 0,!0),_(t).icon?(p(),B(l,{key:0,style:{cursor:"pointer"},flex:"32px",onClick:c[0]||(c[0]=w=>{var b;return(b=_(r))==null?void 0:b.select()})},{default:u(()=>[K(i.$slots,"icon",{},void 0,!0)]),_:3})):$("",!0),e(l,{flex:typeof a.widths.name=="string"?a.widths.name:a.widths.name+"px",class:"text-secondary entity-name",style:{"font-size":"12px",cursor:"pointer"},onClick:c[4]||(c[4]=w=>{var b;return(b=_(r))==null?void 0:b.select()})},{default:u(()=>[le(e(y,{ref_key:"renameInput",ref:n,modelValue:s.value,"onUpdate:modelValue":c[1]||(c[1]=w=>s.value=w),size:"mini",onClick:c[2]||(c[2]=Te(()=>{},["stop"])),onBlur:c[3]||(c[3]=w=>{var b;return(b=_(r))==null?void 0:b.rename(s.value)})},null,8,["modelValue"]),[[re,_(r).renaming]]),le(m("span",null,A(_(r).name),513),[[re,!_(r).renaming]]),K(i.$slots,"name",{},void 0,!0)]),_:3},8,["flex"]),K(i.$slots,"extra",{},void 0,!0),_(t).actions?(p(),B(l,{key:1,flex:typeof a.widths.actions=="string"?a.widths.actions:a.widths.actions+"px",class:"text-secondary text-nowrap d-flex justify-content-end pe-3"},{default:u(()=>[e(C,{size:0,class:"actions justify-content-end"},{split:u(()=>[e(h,{direction:"vertical"})]),default:u(()=>[K(i.$slots,"actions",{},void 0,!0)]),_:3})]),_:3},8,["flex"])):$("",!0)]),_:3},8,["class"])):$("",!0)}}});var Ve=R(Fo,[["__scopeId","data-v-7a84f172"]]);const ho=j({__name:"BrowserOperators",props:{browser:null,space:{type:Boolean}},setup(a){const o=a,t=G.from(o.browser.uid),n=ae(()=>ne.from(o.browser.uid));return(s,r)=>{const d=f("a-tooltip"),i=f("icon-loading"),c=f("a-space");return _(t)?(p(),B(c,{key:0,size:0,class:"justify-content-end align-items-center"},{split:u(()=>[K(s.$slots,"split",{},void 0,!0)]),default:u(()=>[_(n)===void 0||_(n).status==="closed"?(p(),B(d,{key:0,content:"\u542F\u52A8"},{default:u(()=>[e(T,{type:"play_circle",color:"#165dff",class:"fs-6 d-flex",onClick:r[0]||(r[0]=l=>{var y;return(y=_(t))==null?void 0:y.launch()})})]),_:1})):_(n).status==="launched"?(p(),g(S,{key:1},[e(d,{content:"\u7F6E\u9876"},{default:u(()=>[e(T,{type:"push_pin",class:"fs-6 d-flex",color:"#165dff",onClick:r[1]||(r[1]=l=>{var y;return(y=_(t))==null?void 0:y.bringToFront()})})]),_:1}),e(d,{content:"\u91CD\u542F"},{default:u(()=>[e(T,{type:"sync",class:"fs-6 d-flex",color:"#165dff",onClick:r[2]||(r[2]=l=>{var y;return(y=_(t))==null?void 0:y.relaunch()})})]),_:1}),e(d,{content:"\u5173\u95ED"},{default:u(()=>[e(T,{type:"cancel",class:"fs-6 d-flex",color:"#ff0000db",onClick:r[3]||(r[3]=l=>{var y;return(y=_(t))==null?void 0:y.close()})})]),_:1})],64)):_(n).status==="launching"?(p(),B(i,{key:2})):$("",!0),K(s.$slots,"extra",{},void 0,!0)]),_:3})):$("",!0)}}});var lt=R(ho,[["__scopeId","data-v-2835835a"]]);const ze=j({__name:"EntityOperator",props:{entity:null,permissions:{default:()=>["edit","remove","rename"]}},setup(a){const o=a,t=o.entity.type==="browser"?G.from(o.entity.uid):X.from(o.entity.uid);function n(s){return o.permissions.some(r=>r===s)}return(s,r)=>{const d=f("a-doption"),i=f("a-dropdown");return _(t)?(p(),B(i,{key:0,trigger:["hover"]},{content:u(()=>[K(s.$slots,"dropdown"),n("edit")?(p(),B(d,{key:0,onClick:r[0]||(r[0]=c=>{var l;return(l=_(t))==null?void 0:l.select()})},{default:u(()=>[e(T,{type:"edit"}),v(" \u7F16\u8F91 ")]),_:1})):$("",!0),n("rename")?(p(),B(d,{key:1,onClick:r[1]||(r[1]=c=>_(t)&&(_(t).renaming=!0))},{default:u(()=>[e(T,{type:"text_format"}),v(" \u91CD\u547D\u540D ")]),_:1})):$("",!0),n("remove")?(p(),B(d,{key:2,onClick:r[2]||(r[2]=c=>{var l;return(l=_(t))==null?void 0:l.remove()})},{default:u(()=>[e(T,{style:{color:"red"},type:"delete"}),v(" \u5220\u9664 ")]),_:1})):$("",!0),n("location")?(p(),B(d,{key:3,onClick:r[3]||(r[3]=c=>{var l;return(l=_(t))==null?void 0:l.location()})},{default:u(()=>[e(T,{type:"location_on"}),v(" \u8DF3\u8F6C\u5230\u6587\u4EF6\u6240\u5728\u4F4D\u7F6E ")]),_:1})):$("",!0)]),default:u(()=>[e(T,{type:"menu",style:{cursor:"pointer"},class:"fs-6 d-flex"})]),_:3})):$("",!0)}}}),yo={style:{float:"right"}},vo=j({__name:"FileFilters",setup(a){const o=Object;return(t,n)=>{const s=f("a-tag"),r=f("a-space"),d=f("a-option"),i=f("a-select"),c=f("a-input-search");return p(),g(S,null,[e(i,{modelValue:_(F).browser.search.tags,"onUpdate:modelValue":n[0]||(n[0]=l=>_(F).browser.search.tags=l),size:"mini",multiple:"",placeholder:"\u4F7F\u7528\u6807\u7B7E\u641C\u7D22",style:{width:"200px"}},{default:u(()=>[(p(!0),g(S,null,U(_(o).keys(_(F).browser.tags),l=>(p(),g(S,{key:l},[_(F).browser.tags[l]?(p(),B(d,{key:0,value:l,label:l},{default:u(()=>[e(r,null,{default:u(()=>[e(s,{color:_(F).browser.tags[l].color},{default:u(()=>[v(A(l),1)]),_:2},1032,["color"]),m("span",yo,A(_(F).browser.tags[l].count),1)]),_:2},1024)]),_:2},1032,["value","label"])):$("",!0)],64))),128))]),_:1},8,["modelValue"]),e(c,{modelValue:_(F).browser.search.value,"onUpdate:modelValue":n[1]||(n[1]=l=>_(F).browser.search.value=l),size:"mini",placeholder:"\u8F93\u5165\u540D\u5B57,\u5907\u6CE8\u641C\u7D22",style:{width:"240px"}},null,8,["modelValue"])],64)}}});const Eo={class:"breadcrumb"},wo={class:"path-item"},Co=j({__name:"FileBreadcrumb",setup(a){return(o,t)=>{const n=f("a-breadcrumb-item"),s=f("a-breadcrumb");return p(),g("span",Eo,[e(s,null,{default:u(()=>{var r;return[(p(!0),g(S,null,U(_(H)?(r=_(X).from(_(H).uid))==null?void 0:r.flatParents():[],d=>(p(),B(n,{key:d.uid,onClick:i=>{var c;return(c=_(X).from(d.uid))==null?void 0:c.location()}},{default:u(()=>[m("span",wo,A(d.name),1)]),_:2},1032,["onClick"]))),128)),e(n)]}),_:1})])}}});var go=R(Co,[["__scopeId","data-v-308bb34d"]]);const bo=j({__name:"FileHeader",props:{columns:{default:()=>["checkbox","icon","name","extra","actions"]}},setup(a){const o=a;function t(n){return!!o.columns.find(s=>s===n)}return(n,s)=>{const r=f("a-col"),d=f("a-divider"),i=f("a-row");return p(),B(i,{class:"pt-1 pb-1 border-bottom align-items-center entity-properties"},{default:u(()=>[t("checkbox")?(p(),B(r,{key:0,flex:"32px",class:"d-flex"})):$("",!0),t("name")?(p(),B(r,{key:1,class:"entity-property",flex:"160px"},{default:u(()=>[v(" \u6587\u4EF6\u540D ")]),_:1})):$("",!0),t("extra")?(p(),g(S,{key:2},[e(r,{class:"entity-property",flex:"250px"},{default:u(()=>[e(d,{class:"ms-0 m-1",direction:"vertical"}),v(" \u5907\u6CE8 ")]),_:1}),e(r,{class:"entity-property",flex:"250px"},{default:u(()=>[e(d,{class:"ms-0 m-1",direction:"vertical"}),v(" \u6807\u7B7E ")]),_:1})],64)):$("",!0),t("actions")?(p(),B(r,{key:3,class:"entity-property text-end pe-3",flex:"auto"},{default:u(()=>[v(" \u64CD\u4F5C ")]),_:1})):$("",!0)]),_:1})}}});var rt=R(bo,[["__scopeId","data-v-53364416"]]);const Bo=j({__name:"FileOperators",setup(a){async function o(){ve();const n=await Ee.uuid(),s=new X({uid:n,type:"folder",name:"\u672A\u547D\u540D\u6587\u4EF6\u5939",children:{},createTime:Date.now(),parent:H.value.uid,renaming:!0});H.value.children[n]=s}async function t(){ve();const n=await Ee.uuid();H.value.children[n]=new G({type:"browser",uid:n,name:"\u672A\u547D\u540D\u6D4F\u89C8\u5668",checked:!1,createTime:Date.now(),notes:"",tags:[],renaming:!0,parent:H.value.uid,histories:[{action:"\u521B\u5EFA",time:Date.now()}],cachePath:pe?"":await D.path.call("join",F.userDataDirsFolder,n),store:{}})}return(n,s)=>{const r=f("a-button"),d=f("a-dropdown"),i=f("a-space");return p(),B(i,null,{default:u(()=>[e(d,{trigger:"hover"},{content:u(()=>[]),default:u(()=>[e(r,{size:"mini"},{default:u(()=>[e(T,{type:"more_horiz"},{default:u(()=>[v(" \u66F4\u591A ")]),_:1})]),_:1})]),_:1}),e(r,{size:"mini",type:"outline",onClick:o},{default:u(()=>[e(T,{type:"folder"},{default:u(()=>[v(" \u65B0\u5EFA\u6587\u4EF6\u5939 ")]),_:1})]),_:1}),e(r,{size:"mini",type:"outline",onClick:t},{default:u(()=>[e(T,{type:"web"},{default:u(()=>[v(" \u65B0\u5EFA\u6D4F\u89C8\u5668 ")]),_:1})]),_:1})]),_:1})}}});const Do={class:"text-secondary",style:{"font-size":"12px"}},xo=j({__name:"FileMultipleOperators",setup(a){const o=N({showChecked:!1,selectBrowsers:[],pasteType:"copy"}),t=ae(()=>Object.keys(H.value.children).map(E=>H.value.children[E]).filter(E=>E.type==="browser")),n=ae(()=>W.value?W.value.filter(E=>E.type==="browser"):Z().findAll(E=>E.type==="browser")),s=ae(()=>n.value.filter(E=>E.checked));function r(){for(const E of t.value)E.type==="browser"&&(E.checked=!0)}function d(){for(const E of Z().findAll(w=>w.type==="browser"&&w.checked===!0))E.type==="browser"&&(E.checked=!1)}async function i(){var E;for(const w of s.value)await((E=G.from(w.uid))==null?void 0:E.launch())}async function c(){var E;for(const w of s.value)await((E=G.from(w.uid))==null?void 0:E.close())}async function l(){var E;for(const w of s.value)await((E=G.from(w.uid))==null?void 0:E.remove())}function y(){o.selectBrowsers=s.value,o.pasteType="copy"}function h(){o.selectBrowsers=s.value,o.pasteType="cut"}async function C(){const E=JSON.parse(JSON.stringify(o.selectBrowsers));o.selectBrowsers=[];for(const w of E){const b=await Ee.uuid();w.uid=b,w.cachePath=pe?"":await D.path.call("join",F.paths.userDataDirsFolder,b),w.parent=H.value.uid,w.checked=!1,H.value.children[b]=new G(w)}if(o.pasteType==="cut")for(const w of n.value)w.type==="browser"&&w.checked&&await w.remove();d()}return(E,w)=>{const b=f("a-divider"),O=f("a-button"),P=f("icon-down"),x=f("a-doption"),k=f("a-dropdown"),Y=f("a-space"),V=f("a-col"),_e=f("a-checkbox"),Fe=f("a-tooltip"),ct=f("a-drawer"),dt=f("a-row");return p(),B(dt,{class:"col-12 p-1 ps-2 pe-2"},{default:u(()=>[e(V,{flex:"auto"},{default:u(()=>[e(Y,{size:0},{split:u(()=>[e(b,{direction:"vertical"})]),default:u(()=>[e(O,{size:"mini",onClick:r},{default:u(()=>[v(" \u5168\u9009 ")]),_:1}),_(s).length?(p(),g(S,{key:0},[m("span",Do,[v(" \u5F53\u524D\u5171\u9009\u4E2D "+A(_(s).length)+" \u4E2A\u6587\u4EF6 ",1),e(O,{size:"mini",type:"text",onClick:w[0]||(w[0]=ee=>o.showChecked=!0)},{default:u(()=>[v(" \u67E5\u770B ")]),_:1})]),e(k,null,{content:u(()=>[e(x,{style:{width:"100px"},onClick:y},{default:u(()=>[v(" \u590D\u5236 ")]),_:1}),e(x,{onClick:h},{default:u(()=>[v(" \u526A\u5207 ")]),_:1}),e(x,{class:"border-bottom",disabled:o.selectBrowsers.length===0,onClick:C},{default:u(()=>[v(" \u7C98\u8D34 ")]),_:1},8,["disabled"]),e(x,{onClick:i},{default:u(()=>[v(" \u6279\u91CF\u8FD0\u884C ")]),_:1}),e(x,{onClick:c},{default:u(()=>[v(" \u6279\u91CF\u5173\u95ED ")]),_:1}),e(x,{onClick:l},{default:u(()=>[v(" \u6279\u91CF\u5220\u9664 ")]),_:1})]),default:u(()=>[e(O,{size:"mini"},{default:u(()=>[v(" \u9009\u62E9\u6279\u91CF\u64CD\u4F5C "),e(P)]),_:1})]),_:1}),e(O,{size:"mini",onClick:d},{default:u(()=>[v(" \u53D6\u6D88 ")]),_:1})],64)):$("",!0)]),_:1})]),_:1}),_(W)===void 0?(p(),B(Bo,{key:0})):$("",!0),e(ct,{visible:o.showChecked,"onUpdate:visible":w[1]||(w[1]=ee=>o.showChecked=ee),title:`\u5DF2\u9009\u4E2D ${_(s).length} \u4E2A\u6587\u4EF6`,width:740,footer:!1},{default:u(()=>[m("div",null,[e(rt,{columns:["checkbox","name","extra"]}),(p(!0),g(S,null,U(_(s),ee=>(p(),B(Ve,{key:ee.uid,entity:ee},{prefix:u(()=>[e(V,{flex:"32px",class:"d-flex"},{default:u(()=>[e(_e,{modelValue:ee.checked,"onUpdate:modelValue":pt=>ee.checked=pt},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),extra:u(()=>[e(V,{flex:"250px",class:"text-secondary notes"},{default:u(()=>[e(Fe,{content:"\u5907\u6CE8\u63CF\u8FF0",position:"tl"},{default:u(()=>[m("span",null,A(ee.notes),1)]),_:2},1024)]),_:2},1024),e(V,{flex:"250px"},{default:u(()=>[e($e,{tags:ee.tags,"read-only":!0,size:"small"},null,8,["tags"])]),_:2},1024)]),_:2},1032,["entity"]))),128))])]),_:1},8,["visible","title"])]),_:1})}}});var ko=R(xo,[["__scopeId","data-v-53aa2838"]]);const Ao={id:"browsers",class:"h-100"},$o={class:"col-12 p-1 ps-2 pe-2 operations"},So={key:2,class:"col-12 p-2 pt-1 entities-container"},Oo={class:"entities"},Vo=j({__name:"index",setup(a){return(o,t)=>{const n=f("a-button"),s=f("a-divider"),r=f("a-empty"),d=f("a-checkbox"),i=f("a-col"),c=f("a-tooltip");return p(),g("div",Ao,[m("div",$o,[le(e(go,null,null,512),[[re,_(W)===void 0]]),e(vo),_(W)?(p(),B(n,{key:0,size:"mini",onClick:_(ve)},{default:u(()=>[e(T,{type:"restart_alt"},{default:u(()=>[v(" \u91CD\u7F6E ")]),_:1})]),_:1},8,["onClick"])):$("",!0)]),e(ko),e(s,{class:"mt-1 mb-1"}),Object.keys(_(be)).length===0?(p(),B(r,{key:0,class:"p-3",description:"\u6682\u65E0\u4EFB\u4F55\u6D4F\u89C8\u5668"})):_(W)!==void 0&&_(W).length===0?(p(),B(r,{key:1,class:"p-3",description:"\u6682\u65E0\u6D4F\u89C8\u5668\u641C\u7D22\u7ED3\u679C"})):(p(),g("div",So,[e(rt),m("div",Oo,[(p(!0),g(S,null,U(_(W)?_(W):_(be),l=>(p(),g(S,null,[l.type!=="browser"?(p(),B(Ve,{key:l.uid,class:"entity",entity:l},{icon:u(()=>[e(T,{theme:"filled",type:"folder",style:{height:"24px"},class:"fs-5 d-flex ps-1"})]),actions:u(()=>[e(ze,{type:"folder",entity:l,permissions:_(W)?["location"]:["rename","remove"]},null,8,["entity","permissions"])]),_:2},1032,["entity"])):$("",!0)],64))),256)),(p(!0),g(S,null,U(_(W)?_(W):_(be),l=>(p(),g(S,null,[l&&l.type==="browser"?(p(),B(Ve,{key:l.uid,class:"entity",entity:l},{prefix:u(()=>[e(i,{flex:"32px",class:"d-flex"},{default:u(()=>[e(d,{modelValue:l.checked,"onUpdate:modelValue":y=>l.checked=y},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),extra:u(()=>[e(i,{flex:"250px",class:"text-secondary notes"},{default:u(()=>[e(c,{content:"\u5907\u6CE8\u63CF\u8FF0",position:"tl"},{default:u(()=>[m("span",null,A(l.notes),1)]),_:2},1024)]),_:2},1024),e(i,{flex:"250px"},{default:u(()=>[e($e,{tags:l.tags,"read-only":!0,size:"small"},null,8,["tags"])]),_:2},1024)]),actions:u(()=>[e(lt,{browser:l},{split:u(()=>[e(s,{direction:"vertical"})]),_:2},1032,["browser"]),e(ze,{type:"browser",entity:l},null,8,["entity"])]),_:2},1032,["entity"])):$("",!0)],64))),256))])]))])}}});var zo=R(Vo,[["__scopeId","data-v-f5be55b0"]]);const jo={class:"col-12 p-2 m-auto"},Po={class:"d-flex mb-1 align-items-center"},To={class:"browser-title"},Io={class:"text-secondary",style:{"font-size":"12px"}},Mo=["onClick"],Ro=["id"],Uo={key:0},Lo=j({__name:"index",setup(a){const o=N({show:!1,loading:!1}),t=At(s,1e3);ue(()=>[F.dashboard.video.aspectRatio],t),ue(()=>o.show,()=>{o.show?s():n()}),Ct(()=>{o.show=!1,n()});for(const i of q)i.on("relaunching",()=>{var c;i.video=void 0,(c=document.querySelector(`#video-${i.uid}`))==null||c.replaceChildren()}),i.on("relaunched",()=>{t()});async function n(){var i;for(const c of q)(i=c.stream)==null||i.getTracks().forEach(l=>{l.stop()})}async function s(){var c;o.loading=!0,await Promise.all(q.map(l=>new Promise(y=>{var h;l.once("webrtc-page-loaded",y),(h=l.worker)==null||h.call(l,"gotoWebRTCPage")})));const i=await D.desktopCapturer.call("getSources",{types:["window"]});for(const l of q){const y=await r(l.uid,i);y&&(l.stream=y.stream,(c=l.stream)==null||c.getTracks().forEach(C=>{C.applyConstraints({frameRate:1,aspectRatio:F.dashboard.video.aspectRatio===0?void 0:F.dashboard.video.aspectRatio})}),l.video=y.video);const h=document.querySelector(`#video-${l.uid}`);h&&l.video&&h.replaceChildren(l.video)}await Promise.all(q.map(l=>new Promise(y=>{var h;l.once("webrtc-page-closed",y),(h=l.worker)==null||h.call(l,"closeWebRTCPage")}))),o.loading=!1}async function r(i,c){for(const l of c)if(RegExp(i).test(l.name))try{const y=await navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:l.id}}}),h=document.createElement("video");return h.srcObject=y,h.style.display="block",h.style.width="100%",h.poster=l.thumbnail.toDataURL(),h.onloadedmetadata=C=>h.play(),{video:h,stream:y}}catch(y){console.log(y)}}function d(i){var c;(c=ne.from(i))==null||c.bringToFront()}return(i,c)=>{const l=f("a-divider"),y=f("a-switch"),h=f("a-select"),C=f("a-button"),E=f("a-tooltip"),w=f("a-space"),b=f("a-empty"),O=f("a-col"),P=f("a-row");return p(),g("div",jo,[m("div",Po,[e(w,{size:0},{split:u(()=>[e(l,{direction:"vertical"})]),default:u(()=>[e(y,{modelValue:_(F).dashboard.details.tags,"onUpdate:modelValue":c[0]||(c[0]=x=>_(F).dashboard.details.tags=x)},{checked:u(()=>[v(" \u663E\u793A\u6807\u7B7E ")]),unchecked:u(()=>[v(" \u663E\u793A\u6807\u7B7E ")]),_:1},8,["modelValue"]),e(y,{modelValue:_(F).dashboard.details.notes,"onUpdate:modelValue":c[1]||(c[1]=x=>_(F).dashboard.details.notes=x)},{checked:u(()=>[v(" \u663E\u793A\u5907\u6CE8 ")]),unchecked:u(()=>[v(" \u663E\u793A\u5907\u6CE8 ")]),_:1},8,["modelValue"]),e(h,{modelValue:_(F).dashboard.num,"onUpdate:modelValue":c[2]||(c[2]=x=>_(F).dashboard.num=x),size:"small",style:{width:"100px"},options:[1,2,4,6,8].map(x=>({value:x,label:`\u663E\u793A${x}\u5217`}))},null,8,["modelValue","options"]),e(h,{modelValue:_(F).dashboard.video.aspectRatio,"onUpdate:modelValue":c[3]||(c[3]=x=>_(F).dashboard.video.aspectRatio=x),size:"small",style:{width:"140px"},options:[[0,"\u9ED8\u8BA4"],[4/3,"4:3"],[16/9,"16:9"]].map(x=>({selected:x[0]===_(F).dashboard.video.aspectRatio,value:x[0],label:x[1]}))},{prefix:u(()=>[v(" \u6A2A\u7EB5\u6BD4 ")]),_:1},8,["modelValue","options"]),e(E,{content:"\u663E\u793A\u6BCF\u4E2A\u6D4F\u89C8\u5668\u7684\u56FE\u50CF\uFF0C\u5982\u679C\u592A\u591A\u6D4F\u89C8\u5668\u53EF\u80FD\u4F1A\u9020\u6210\u7535\u8111\u5361\u987F"},{default:u(()=>[e(C,{size:"small",type:"outline",disabled:_(q).length===0,onClick:c[4]||(c[4]=x=>o.show=!o.show)},{default:u(()=>[v(A(o.show?"\u6682\u505C":"\u5F00\u59CB")+"\u76D1\u63A7 ",1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_(q).length===0?(p(),B(b,{key:0,class:"pt-5",description:"\u6CA1\u6709\u8FD0\u884C\u4E2D\u7684\u6D4F\u89C8\u5668"})):o.show===!1?(p(),B(b,{key:1,class:"pt-5",description:"\u5F53\u524D\u76D1\u63A7\u5DF2\u6682\u505C\uFF0C\u8BF7\u70B9\u51FB\u76D1\u63A7\u6309\u94AE\u91CD\u65B0\u76D1\u63A7"})):(p(),g(S,{key:2},[le(e(b,{class:"pt-5",description:"\u52A0\u8F7D\u4E2D..."},null,512),[[re,o.loading===!0]]),le(m("div",{class:"dashboard mt-2",style:Pe({"grid-template-columns":`repeat(${_(F).dashboard.num}, 1fr)`})},[(p(!0),g(S,null,U(_(q),x=>(p(),g("div",{key:x.uid,class:"browser"},[m("div",To,[e(P,null,{default:u(()=>[e(O,{flex:"100px"},{default:u(()=>[m("span",Io,A(x.browser.name),1)]),_:2},1024),e(O,{flex:"auto",class:"d-flex align-content-center justify-content-end text-end"},{default:u(()=>[e(w,{size:0,class:"justify-content-end"},{split:u(()=>[e(l,{direction:"vertical",class:"ms-1 me-1"})]),default:u(()=>[e(lt,{space:!1,browser:x.browser},{split:u(()=>[e(l,{direction:"vertical",class:"ms-1 me-1"})]),_:2},1032,["browser"]),e(ze,{type:"browser",entity:x.browser,permissions:["location"]},null,8,["entity"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),m("div",{class:"browser-video",onClick:k=>d(x.uid)},[e(E,{content:"\u70B9\u51FB\u64CD\u63A7\u6D4F\u89C8\u5668"},{default:u(()=>[m("div",{id:"video-"+x.uid},null,8,Ro)]),_:2},1024),x.video===void 0?(p(),g("span",Uo,[x.status==="launching"?(p(),B(b,{key:0,description:"\u7B49\u5F85\u6D4F\u89C8\u5668\u542F\u52A8..."})):x.status==="launched"?(p(),B(b,{key:1,description:"\u7B49\u5F85\u56FE\u50CF\u521D\u59CB\u5316..."})):$("",!0)])):$("",!0)],8,Mo),_(F).dashboard.details.notes||_(F).dashboard.details.tags?(p(),B(P,{key:0},{default:u(()=>[_(F).dashboard.details.tags?(p(),B(O,{key:0,style:{width:"100px"},flex:"100px"},{default:u(()=>[e($e,{tags:x.browser.tags,"read-only":!0,size:"small"},null,8,["tags"])]),_:2},1024)):$("",!0),_(F).dashboard.details.notes?(p(),B(O,{key:1,style:{width:"100px"},flex:"100px",class:"text-secondary notes"},{default:u(()=>[e(E,{content:"\u5907\u6CE8\u63CF\u8FF0",position:"tl"},{default:u(()=>[m("span",null,A(x.browser.notes),1)]),_:2},1024)]),_:2},1024)):$("",!0)]),_:2},1024)):$("",!0)]))),128))],4),[[re,o.loading===!1]])],64))])}}});var No=R(Lo,[["__scopeId","data-v-263830a4"]]);const qo=["onMouseover"],Jo={key:0,class:"col-12"},Wo={class:"user-script-name"},Yo=["href"],Ko=["title"],Ho=["href"],Xo=["src"],Zo={class:"ms-1"},Go={class:"user-script-infos"},Qo={key:1,class:"col-12"},en={class:"user-script-name"},tn=["href"],un={class:"user-script-actions"},on=j({__name:"ScriptList",props:{scripts:null},setup(a){const o=a,{scripts:t}=we(o),n=L(0);function s(r){const d=Date.now(),i=d-r;let c="";const y=60*1e3,h=60*y,C=24*h,E=[31,28,31,30,31,30,31,31,30,31,30,31],w=new Date(d).getFullYear(),b=new Date(d).getMonth();(w%4===0&&w%100!==0||w%400===0)&&(E[1]=29);const O=Math.abs(new Date(r).getMonth()-b),P=w-new Date(r).getFullYear();if(P!==0&&O>=12)c=P+"\u5E74";else{if(O!==0&&Math.floor(i/C)>=E[b])return O+"\u4E2A\u6708";x(C)!==0?c=x(C)+"\u5929":x(h)!==0?c=x(h)+"\u5C0F\u65F6":x(y)!==0?c=x(y)+"\u5206\u949F":c="\u521A\u521A"}function x(k){return Math.floor(i/k)}return c}return(r,d)=>{const i=f("a-tag"),c=f("a-space");return p(!0),g(S,null,U(_(t),(l,y)=>(p(),g("div",{key:y,class:ke(["user-script d-flex",{"user-script-active":l.id===n.value}]),onMouseleave:d[0]||(d[0]=h=>n.value=0),onMouseover:h=>n.value=l.id},[l.info?(p(),g("div",Jo,[m("div",Wo,[m("a",{target:"_blank",href:l.info.url},[m("span",null,A(l.info.name),1)],8,Yo)]),m("div",{class:"user-script-descriptions",title:l.info.description},[(p(!0),g(S,null,U(l.info.authors,(h,C)=>(p(),g("a",{key:C,href:h.url,class:"user-script-author",target:"_blank"},[h.avatar?(p(),g("img",{key:0,src:h.avatar,class:"user-script-icon"},null,8,Xo)):(p(),B(T,{key:1,type:"account_circle",style:{"margin-top":"4px"},class:"user-script-icon"})),m("span",Zo,A(h.name),1)],8,Ho))),128)),v(" \uFF1A "+A(l.info.description),1)],8,Ko),m("div",Go,[e(c,{size:"mini"},{default:u(()=>[e(i,{color:"blue",title:"\u4ECA\u65E5\u5B89\u88C5"},{default:u(()=>[v(" \u2B07\uFE0F"),m("b",null,A(l.info.daily_installs),1)]),_:2},1024),e(i,{color:"green",title:"\u603B\u5B89\u88C5"},{default:u(()=>[v(" \u{1F4E6}"),m("b",null,A(l.info.total_installs),1)]),_:2},1024),e(i,{color:"red",title:"\u7248\u672C"},{default:u(()=>[v(" v"),m("b",null,A(l.info.version),1)]),_:2},1024),e(i,{color:"orange",title:"\u8BC4\u5206"},{default:u(()=>[v(" \u2B50"),m("b",null,A(l.info.ratings?l.info.ratings.toFixed(1):"\u65E0"),1)]),_:2},1024),e(i,{title:"\u521B\u5EFA\u65F6\u95F4"},{default:u(()=>[v(A(new Date(l.info.createTime).toLocaleDateString())+" \u521B\u5EFA ",1)]),_:2},1024),e(i,{title:"\u66F4\u65B0\u65F6\u95F4"},{default:u(()=>[v(A(s(l.info.updateTime))+" \u524D\u66F4\u65B0 ",1)]),_:2},1024)]),_:2},1024)])])):(p(),g("div",Qo,[m("div",en,[m("a",{target:"_blank",href:`file://${l.url}`},[m("span",null,A(l.url),1)],8,tn)])])),m("div",un,[K(r.$slots,"actions",{script:l,alreadyInstalled:_(F).scripts.find(h=>h.id===l.id)!==void 0},void 0,!0)])],42,qo))),128)}}});var We=R(on,[["__scopeId","data-v-72a22d47"]]);const nn=a=>(De("data-v-1671469d"),a=a(),xe(),a),sn={class:"col-12 ps-3 pe-3 m-auto"},an={class:"markdown"},ln=nn(()=>m("code",null,"\u5B89\u88C5/\u66F4\u65B0",-1)),rn={for:"local-file"},cn={key:0},dn={key:1,class:"p-2"},pn={class:"user-script-page"},_n={class:"col-12 actions d-flex"},fn={class:"col-12"},mn={key:0},Fn={key:1},hn={key:2},yn={key:3,class:"user-script-list"},vn={class:"pb-1"},En=["href"],wn=j({__name:"index",setup(a){const o=L(Be.scriptSearchEngines.map(l=>({engine:l,list:[]}))),t=L("web"),n=L(Be.scriptSearchEngines[0].name),s=L("");function r(l){o.value.forEach(async y=>{y.loading=!0,y.error=!1;try{const h=await y.engine.search(l,1,10);y.list=h.map(C=>({id:C.id,url:C.code_url,enable:!0,info:C}))}catch(h){console.log(h),y.list=[],y.error=!0}y.loading=!1})}function d(l){F.scripts.push(l)}function i(l){F.scripts.splice(F.scripts.indexOf(l),1)}function c(){document.querySelector("#local-file").click()}return(l,y)=>{const h=f("a-button"),C=f("a-empty"),E=f("a-tooltip"),w=f("a-tab-pane"),b=f("a-input-search"),O=f("a-skeleton-line"),P=f("a-skeleton"),x=f("a-tabs");return p(),g("div",sn,[m("p",an,[v(" \u542F\u52A8\u6D4F\u89C8\u5668\u540E\u5C06\u4F1A\u81EA\u52A8 "),ln,v(" \u4EE5\u4E0B\u811A\u672C\u5230\u6D4F\u89C8\u5668\u3002 "),m("label",rn,[e(h,{size:"mini",onClick:c},{default:u(()=>[v(" + \u6DFB\u52A0\u672C\u5730\u811A\u672C ")]),_:1})]),m("input",{id:"local-file",style:{display:"none"},name:"local-file",type:"file",accept:".js",onChange:y[0]||(y[0]=(...k)=>_(Je)&&_(Je)(...k))},null,32)]),e(x,{activeKey:t.value,"onUpdate:activeKey":y[3]||(y[3]=k=>t.value=k),class:"h-100"},{default:u(()=>[e(w,{key:"web",title:"\u811A\u672C\u5217\u8868"},{default:u(()=>[_(F).scripts.length===0?(p(),g("div",cn,[e(C,{description:"\u6682\u65E0\u6570\u636E, \u8BF7\u5728\u4E0A\u65B9\u201C\u641C\u7D22\u811A\u672C\u201D\u4E2D\u9009\u62E9\u559C\u6B22\u7684\u811A\u672C\u8FDB\u884C\u6DFB\u52A0\u54E6~"})])):(p(),g("div",dn,[e(We,{scripts:_(F).scripts},{actions:u(({script:k})=>[e(E,{content:"\u79FB\u9664\u811A\u672C"},{default:u(()=>[e(h,{size:"small",status:"danger",class:"user-script-action",onClick:Y=>i(k)},{default:u(()=>[e(T,{type:"delete"})]),_:2},1032,["onClick"])]),_:2},1024),e(E,{content:k.enable?"\u5173\u95ED\u811A\u672C\u81EA\u52A8\u5B89\u88C5":"\u5F00\u542F\u811A\u672C\u81EA\u52A8\u5B89\u88C5"},{default:u(()=>[e(h,{size:"small",type:k.enable?"outline":void 0,class:"user-script-action",style:{background:"white"},onClick:Y=>k.enable=!k.enable},{default:u(()=>[e(T,{type:k.enable?"pause":"play-circle"},null,8,["type"])]),_:2},1032,["type","onClick"])]),_:2},1032,["content"])]),_:1},8,["scripts"])]))]),_:1}),e(w,{key:"search",title:"\u811A\u672C\u641C\u7D22"},{default:u(()=>[m("div",pn,[m("div",_n,[e(b,{value:s.value,"onUpdate:value":y[1]||(y[1]=k=>s.value=k),placeholder:"\u8F93\u5165\u811A\u672C\u540D\u8FDB\u884C\u641C\u7D22","search-button":"",onChange:r},null,8,["value"])]),m("div",fn,[e(x,{activeKey:n.value,"onUpdate:activeKey":y[2]||(y[2]=k=>n.value=k)},{default:u(()=>[(p(!0),g(S,null,U(o.value,k=>(p(),B(w,{key:k.engine.name,title:k.engine.name},{default:u(()=>[k.loading?(p(),g("div",mn,[e(P,{animation:""},{default:u(()=>[e(O,{rows:3})]),_:1})])):k.error?(p(),g("div",Fn,[e(C,{description:"\u8BF7\u6C42\u51FA\u9519\uFF0C\u53EF\u80FD\u662F\u670D\u52A1\u5668\u95EE\u9898\uFF0C\u6216\u8005\u7F51\u7EDC\u95EE\u9898\uFF0C\u8BF7\u91CD\u65B0\u5C1D\u8BD5\u3002"})])):k.list.length===0?(p(),g("div",hn,[e(C,{description:"\u6682\u65E0\u6570\u636E"})])):(p(),g("div",yn,[m("div",vn,[v(" \u6570\u636E\u6765\u6E90 : "),m("a",{href:k.engine.homepage,target:"_blank"},A(k.engine.homepage),9,En)]),e(We,{scripts:k.list},{actions:u(({script:Y,alreadyInstalled:V})=>[e(h,{size:"small",class:"user-script-action",disabled:V,type:V?void 0:"outline",onClick:_e=>d(Y)},{default:u(()=>[e(T,{type:"add"}),v(" "+A(V?"\u5DF2\u6DFB\u52A0":"\u6DFB\u52A0"),1)]),_:2},1032,["disabled","type","onClick"])]),_:2},1032,["scripts"])]))]),_:2},1032,["title"]))),128))]),_:1},8,["activeKey"])])])]),_:1})]),_:1},8,["activeKey"])])}}});var Cn=R(wn,[["__scopeId","data-v-1671469d"]]);const gn={class:"col-12 ps-1 pe-1 m-auto"},bn={class:"text-secondary text-small markdown"},Bn=m("code",null,"\u6D4F\u89C8\u5668\u62D3\u5C55",-1),Dn=m("code",null,"\u5B58\u50A8\u8DEF\u5F84",-1),xn=m("br",null,null,-1),kn=m("code",null,"\u5F53\u524D\u5B58\u50A8\u8DEF\u5F84",-1),An=m("br",null,null,-1),$n=m("code",null,"\u7528\u6237\u811A\u672C\u7BA1\u7406\u5668",-1),Sn={key:0},On=j({__name:"index",setup(a){const o=L(!0),t=L([]);ie(async()=>{for(const s of Be.extensionSearchEngines){const r=await s.search();t.value=t.value.concat(r)}for(const s of t.value)s.installed=await D.fs.call("existsSync",`${F.extensionsFolder}/${s.name}`);o.value=!1});async function n(s){await D.fs.call("rmdirSync",await D.path.call("join",F.extensionsFolder,s.name),{recursive:!0}),s.installed=!1}return(s,r)=>{const d=f("a-skeleton-line"),i=f("a-skeleton"),c=f("a-table");return p(),g("div",gn,[m("p",bn,[Bn,v(" \u4F1A\u5728\u6D4F\u89C8\u5668\u542F\u52A8\u65F6\u81EA\u52A8\u52A0\u8F7D\uFF08\u4F60\u4E5F\u53EF\u4EE5\u624B\u52A8\u4E0B\u8F7D\u5E76\u89E3\u538B\u5230 "),Dn,v(" \u4E2D\uFF09\u3002"),xn,kn,v(" "+A(_(F).extensionsFolder)+" ",1),An,$n,v(" \u53EA\u80FD\u5B58\u5728\u4E00\u4E2A\uFF0C\u5426\u5219\u53EF\u80FD\u9020\u6210\u811A\u672C\u4E4B\u95F4\u7684\u51B2\u7A81 ")]),o.value?(p(),g("div",Sn,[e(i,{animation:""},{default:u(()=>[e(d,{rows:3})]),_:1})])):(p(),B(c,{key:1,size:"small",data:t.value.map(l=>({key:l.name,...l})),columns:[{title:"\u56FE\u6807",width:64,dataIndex:"icon",render:({rowIndex:l})=>z("img",{src:t.value[l].icon,style:{width:"32px"}})},{title:"\u540D\u79F0",dataIndex:"name"},{title:"\u7B80\u4ECB",dataIndex:"description",ellipsis:!0},{title:"\u5B98\u7F51",dataIndex:"homepage",render:({rowIndex:l})=>z("a",{href:t.value[l].homepage},t.value[l].homepage)},{title:"\u64CD\u4F5C",width:84,fixed:"right",dataIndex:"actions",render:({rowIndex:l})=>z("span",[t.value[l].installed?z(_(ye),{type:"text",danger:!0,size:"small",onClick:()=>n(t.value[l])},["\u5378\u8F7D"]):z(_(ye),{type:"text",size:"small",onClick:()=>_(st)(t.value,t.value[l])},["\u5B89\u88C5"])])}]},null,8,["data","columns"]))])}}}),Be=N({routes:[{name:"index",path:"/",redirect:"/browsers",component:ce(Iu),children:[{name:"browsers",path:"browsers",component:ce(zo),meta:{icon:"view_list",filledIcon:"view_list",title:"\u6D4F\u89C8\u5668\u5217\u8868"}},{name:"dashboard",path:"dashboard",component:ce(No),meta:{icon:"image",filledIcon:"image",title:"\u76D1\u63A7\u53F0"}},{name:"user-scripts",path:"user-scripts",component:ce(Cn),meta:{icon:"code",filledIcon:"code",title:"\u7528\u6237\u811A\u672C"}},{name:"extensions",path:"extensions",component:ce(On),meta:{icon:"extension",filledIcon:"extension",title:"\u6D4F\u89C8\u5668\u62D3\u5C55",tutorial:{step:3,placement:"rightTop",tooltip:"4. \u6D4F\u89C8\u5668\u62D3\u5C55\u4F1A\u5BF9\u7528\u6237\u811A\u672C\u8FDB\u884C\u7BA1\u7406\u4EE5\u53CA\u89E3\u6790\u548C\u8FD0\u884C\u3002"}}},{name:"setting",path:"setting",component:ce(mo),meta:{icon:"settings",filledIcon:"settings",title:"\u8BBE\u7F6E"}}]},{name:"bookmarks",path:"/bookmarks",component:ce(Zu),meta:{icon:"view_list",filledIcon:"view_list",title:"\u4E66\u7B7E\u5217\u8868",hideInMenu:!0}}],themes:{dark:!1},extensionSearchEngines:[{name:"OCS\u5B98\u65B9\u62D3\u5C55",homepage:"https://cdn.ocsjs.com",async search(){return(await Ae()).extensions}}],scriptSearchEngines:[{name:"ScriptCat - \u811A\u672C\u732B",homepage:"https://scriptcat.org",search:async(a,o,t)=>{let s=(await D.methods.call("get","https://scriptcat.org/api/v1/scripts?"+new URLSearchParams({count:t.toString(),page:o<=0?"1":o.toString(),keyword:a}))).list;return s=s.sort((r,d)=>d.today_install-r.today_install),s.map(r=>({id:r.script.script_id,version:r.script.version,authors:[{url:`https://scriptcat.org/users/${r.user_id}`,name:r.username,avatar:r.avatar?`https://scriptcat.org${r.avatar}`:void 0}],name:r.name,description:r.description,url:`https://scriptcat.org/script-show-page/${r.script.script_id}`,code_url:`https://scriptcat.org/scripts/code/${r.script.script_id}/${r.name}.user.js`,ratings:r.score?r.score*2/10:0,createTime:r.createtime*1e3,updateTime:r.updatetime*1e3,daily_installs:r.today_install,total_installs:r.total_install}))}},{name:"GreasyFork",homepage:"https://greasyfork.org",search:async(a,o,t)=>{let s=await D.methods.call("get","https://greasyfork.org/zh-CN/scripts.json?"+new URLSearchParams({q:a,page:o<=0?"1":o.toString()}));return s=s.sort((r,d)=>d.daily_installs-r.daily_installs),s.map(r=>{const d=r.good_ratings/(r.good_ratings+r.bad_ratings)*10;return{url:r.url,name:r.name,description:r.description,homepage:r.url,id:r.id,createTime:new Date(r.created_at).getTime(),updateTime:new Date(r.code_updated_at).getTime(),daily_installs:r.daily_installs,total_installs:r.total_installs,authors:r.users,ratings:d?parseFloat(d.toFixed(1)):0,code_url:r.code_url,license:r.license,version:r.version}})}}]}),it=Be.routes,me=Bt({history:Dt(),routes:it});me.beforeEach(()=>!0);window.addEventListener("error",function(a){console.error(a),!(a instanceof ErrorEvent&&a.message==="ResizeObserver loop limit exceeded")&&(D.logger.call("error","\u672A\u77E5\u7684\u9519\u8BEF",a),Q("\u672A\u77E5\u7684\u9519\u8BEF",a instanceof ErrorEvent?a.error:a,"render-error",{type:"error",copy:!0}))});window.addEventListener("unhandledrejection",function(a){a.promise.catch(o=>{console.error(o),D.logger.call("error","\u672A\u6355\u83B7\u7684\u5F02\u6B65\u9519\u8BEF",o),Q("\u672A\u6355\u83B7\u7684\u5F02\u6B65\u9519\u8BEF",o,"render-error",{type:"error",copy:!0})})});gt(Mt).use(me).use(yt).use(vt).use(St).component("IconFont",Et.addFromIconFontCn({src:"js/acro.font.js"})).directive("focus",{mounted(a){a.focus()}}).mount("#app");
